{"version":3,"file":"9406.786ee8e.js","mappings":"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","sources":["webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/vscode-jsonrpc/lib/browser/main.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/vscode-jsonrpc/lib/browser/ril.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/vscode-jsonrpc/lib/common/api.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/vscode-jsonrpc/lib/common/cancellation.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/vscode-jsonrpc/lib/common/connection.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/vscode-jsonrpc/lib/common/disposable.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/vscode-jsonrpc/lib/common/events.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/vscode-jsonrpc/lib/common/is.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/vscode-jsonrpc/lib/common/linkedMap.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/vscode-jsonrpc/lib/common/messageBuffer.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/vscode-jsonrpc/lib/common/messageReader.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/vscode-jsonrpc/lib/common/messageWriter.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/vscode-jsonrpc/lib/common/messages.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/vscode-jsonrpc/lib/common/ral.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/vscode-jsonrpc/lib/common/semaphore.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/vscode-jsonrpc/lib/common/sharedArrayCancellation.js"],"sourcesContent":["\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createMessageConnection = exports.BrowserMessageWriter = exports.BrowserMessageReader = void 0;\nconst ril_1 = require(\"./ril\");\n// Install the browser runtime abstract.\nril_1.default.install();\nconst api_1 = require(\"../common/api\");\n__exportStar(require(\"../common/api\"), exports);\nclass BrowserMessageReader extends api_1.AbstractMessageReader {\n    constructor(port) {\n        super();\n        this._onData = new api_1.Emitter();\n        this._messageListener = (event) => {\n            this._onData.fire(event.data);\n        };\n        port.addEventListener('error', (event) => this.fireError(event));\n        port.onmessage = this._messageListener;\n    }\n    listen(callback) {\n        return this._onData.event(callback);\n    }\n}\nexports.BrowserMessageReader = BrowserMessageReader;\nclass BrowserMessageWriter extends api_1.AbstractMessageWriter {\n    constructor(port) {\n        super();\n        this.port = port;\n        this.errorCount = 0;\n        port.addEventListener('error', (event) => this.fireError(event));\n    }\n    write(msg) {\n        try {\n            this.port.postMessage(msg);\n            return Promise.resolve();\n        }\n        catch (error) {\n            this.handleError(error, msg);\n            return Promise.reject(error);\n        }\n    }\n    handleError(error, msg) {\n        this.errorCount++;\n        this.fireError(error, msg, this.errorCount);\n    }\n    end() {\n    }\n}\nexports.BrowserMessageWriter = BrowserMessageWriter;\nfunction createMessageConnection(reader, writer, logger, options) {\n    if (logger === undefined) {\n        logger = api_1.NullLogger;\n    }\n    if (api_1.ConnectionStrategy.is(options)) {\n        options = { connectionStrategy: options };\n    }\n    return (0, api_1.createMessageConnection)(reader, writer, logger, options);\n}\nexports.createMessageConnection = createMessageConnection;\n","\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst api_1 = require(\"../common/api\");\nclass MessageBuffer extends api_1.AbstractMessageBuffer {\n    constructor(encoding = 'utf-8') {\n        super(encoding);\n        this.asciiDecoder = new TextDecoder('ascii');\n    }\n    emptyBuffer() {\n        return MessageBuffer.emptyBuffer;\n    }\n    fromString(value, _encoding) {\n        return (new TextEncoder()).encode(value);\n    }\n    toString(value, encoding) {\n        if (encoding === 'ascii') {\n            return this.asciiDecoder.decode(value);\n        }\n        else {\n            return (new TextDecoder(encoding)).decode(value);\n        }\n    }\n    asNative(buffer, length) {\n        if (length === undefined) {\n            return buffer;\n        }\n        else {\n            return buffer.slice(0, length);\n        }\n    }\n    allocNative(length) {\n        return new Uint8Array(length);\n    }\n}\nMessageBuffer.emptyBuffer = new Uint8Array(0);\nclass ReadableStreamWrapper {\n    constructor(socket) {\n        this.socket = socket;\n        this._onData = new api_1.Emitter();\n        this._messageListener = (event) => {\n            const blob = event.data;\n            blob.arrayBuffer().then((buffer) => {\n                this._onData.fire(new Uint8Array(buffer));\n            }, () => {\n                (0, api_1.RAL)().console.error(`Converting blob to array buffer failed.`);\n            });\n        };\n        this.socket.addEventListener('message', this._messageListener);\n    }\n    onClose(listener) {\n        this.socket.addEventListener('close', listener);\n        return api_1.Disposable.create(() => this.socket.removeEventListener('close', listener));\n    }\n    onError(listener) {\n        this.socket.addEventListener('error', listener);\n        return api_1.Disposable.create(() => this.socket.removeEventListener('error', listener));\n    }\n    onEnd(listener) {\n        this.socket.addEventListener('end', listener);\n        return api_1.Disposable.create(() => this.socket.removeEventListener('end', listener));\n    }\n    onData(listener) {\n        return this._onData.event(listener);\n    }\n}\nclass WritableStreamWrapper {\n    constructor(socket) {\n        this.socket = socket;\n    }\n    onClose(listener) {\n        this.socket.addEventListener('close', listener);\n        return api_1.Disposable.create(() => this.socket.removeEventListener('close', listener));\n    }\n    onError(listener) {\n        this.socket.addEventListener('error', listener);\n        return api_1.Disposable.create(() => this.socket.removeEventListener('error', listener));\n    }\n    onEnd(listener) {\n        this.socket.addEventListener('end', listener);\n        return api_1.Disposable.create(() => this.socket.removeEventListener('end', listener));\n    }\n    write(data, encoding) {\n        if (typeof data === 'string') {\n            if (encoding !== undefined && encoding !== 'utf-8') {\n                throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${encoding}`);\n            }\n            this.socket.send(data);\n        }\n        else {\n            this.socket.send(data);\n        }\n        return Promise.resolve();\n    }\n    end() {\n        this.socket.close();\n    }\n}\nconst _textEncoder = new TextEncoder();\nconst _ril = Object.freeze({\n    messageBuffer: Object.freeze({\n        create: (encoding) => new MessageBuffer(encoding)\n    }),\n    applicationJson: Object.freeze({\n        encoder: Object.freeze({\n            name: 'application/json',\n            encode: (msg, options) => {\n                if (options.charset !== 'utf-8') {\n                    throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${options.charset}`);\n                }\n                return Promise.resolve(_textEncoder.encode(JSON.stringify(msg, undefined, 0)));\n            }\n        }),\n        decoder: Object.freeze({\n            name: 'application/json',\n            decode: (buffer, options) => {\n                if (!(buffer instanceof Uint8Array)) {\n                    throw new Error(`In a Browser environments only Uint8Arrays are supported.`);\n                }\n                return Promise.resolve(JSON.parse(new TextDecoder(options.charset).decode(buffer)));\n            }\n        })\n    }),\n    stream: Object.freeze({\n        asReadableStream: (socket) => new ReadableStreamWrapper(socket),\n        asWritableStream: (socket) => new WritableStreamWrapper(socket)\n    }),\n    console: console,\n    timer: Object.freeze({\n        setTimeout(callback, ms, ...args) {\n            const handle = setTimeout(callback, ms, ...args);\n            return { dispose: () => clearTimeout(handle) };\n        },\n        setImmediate(callback, ...args) {\n            const handle = setTimeout(callback, 0, ...args);\n            return { dispose: () => clearTimeout(handle) };\n        },\n        setInterval(callback, ms, ...args) {\n            const handle = setInterval(callback, ms, ...args);\n            return { dispose: () => clearInterval(handle) };\n        },\n    })\n});\nfunction RIL() {\n    return _ril;\n}\n(function (RIL) {\n    function install() {\n        api_1.RAL.install(_ril);\n    }\n    RIL.install = install;\n})(RIL || (RIL = {}));\nexports.default = RIL;\n","\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\n/// <reference path=\"../../typings/thenable.d.ts\" />\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ProgressType = exports.ProgressToken = exports.createMessageConnection = exports.NullLogger = exports.ConnectionOptions = exports.ConnectionStrategy = exports.AbstractMessageBuffer = exports.WriteableStreamMessageWriter = exports.AbstractMessageWriter = exports.MessageWriter = exports.ReadableStreamMessageReader = exports.AbstractMessageReader = exports.MessageReader = exports.SharedArrayReceiverStrategy = exports.SharedArraySenderStrategy = exports.CancellationToken = exports.CancellationTokenSource = exports.Emitter = exports.Event = exports.Disposable = exports.LRUCache = exports.Touch = exports.LinkedMap = exports.ParameterStructures = exports.NotificationType9 = exports.NotificationType8 = exports.NotificationType7 = exports.NotificationType6 = exports.NotificationType5 = exports.NotificationType4 = exports.NotificationType3 = exports.NotificationType2 = exports.NotificationType1 = exports.NotificationType0 = exports.NotificationType = exports.ErrorCodes = exports.ResponseError = exports.RequestType9 = exports.RequestType8 = exports.RequestType7 = exports.RequestType6 = exports.RequestType5 = exports.RequestType4 = exports.RequestType3 = exports.RequestType2 = exports.RequestType1 = exports.RequestType0 = exports.RequestType = exports.Message = exports.RAL = void 0;\nexports.MessageStrategy = exports.CancellationStrategy = exports.CancellationSenderStrategy = exports.CancellationReceiverStrategy = exports.ConnectionError = exports.ConnectionErrors = exports.LogTraceNotification = exports.SetTraceNotification = exports.TraceFormat = exports.TraceValues = exports.Trace = void 0;\nconst messages_1 = require(\"./messages\");\nObject.defineProperty(exports, \"Message\", { enumerable: true, get: function () { return messages_1.Message; } });\nObject.defineProperty(exports, \"RequestType\", { enumerable: true, get: function () { return messages_1.RequestType; } });\nObject.defineProperty(exports, \"RequestType0\", { enumerable: true, get: function () { return messages_1.RequestType0; } });\nObject.defineProperty(exports, \"RequestType1\", { enumerable: true, get: function () { return messages_1.RequestType1; } });\nObject.defineProperty(exports, \"RequestType2\", { enumerable: true, get: function () { return messages_1.RequestType2; } });\nObject.defineProperty(exports, \"RequestType3\", { enumerable: true, get: function () { return messages_1.RequestType3; } });\nObject.defineProperty(exports, \"RequestType4\", { enumerable: true, get: function () { return messages_1.RequestType4; } });\nObject.defineProperty(exports, \"RequestType5\", { enumerable: true, get: function () { return messages_1.RequestType5; } });\nObject.defineProperty(exports, \"RequestType6\", { enumerable: true, get: function () { return messages_1.RequestType6; } });\nObject.defineProperty(exports, \"RequestType7\", { enumerable: true, get: function () { return messages_1.RequestType7; } });\nObject.defineProperty(exports, \"RequestType8\", { enumerable: true, get: function () { return messages_1.RequestType8; } });\nObject.defineProperty(exports, \"RequestType9\", { enumerable: true, get: function () { return messages_1.RequestType9; } });\nObject.defineProperty(exports, \"ResponseError\", { enumerable: true, get: function () { return messages_1.ResponseError; } });\nObject.defineProperty(exports, \"ErrorCodes\", { enumerable: true, get: function () { return messages_1.ErrorCodes; } });\nObject.defineProperty(exports, \"NotificationType\", { enumerable: true, get: function () { return messages_1.NotificationType; } });\nObject.defineProperty(exports, \"NotificationType0\", { enumerable: true, get: function () { return messages_1.NotificationType0; } });\nObject.defineProperty(exports, \"NotificationType1\", { enumerable: true, get: function () { return messages_1.NotificationType1; } });\nObject.defineProperty(exports, \"NotificationType2\", { enumerable: true, get: function () { return messages_1.NotificationType2; } });\nObject.defineProperty(exports, \"NotificationType3\", { enumerable: true, get: function () { return messages_1.NotificationType3; } });\nObject.defineProperty(exports, \"NotificationType4\", { enumerable: true, get: function () { return messages_1.NotificationType4; } });\nObject.defineProperty(exports, \"NotificationType5\", { enumerable: true, get: function () { return messages_1.NotificationType5; } });\nObject.defineProperty(exports, \"NotificationType6\", { enumerable: true, get: function () { return messages_1.NotificationType6; } });\nObject.defineProperty(exports, \"NotificationType7\", { enumerable: true, get: function () { return messages_1.NotificationType7; } });\nObject.defineProperty(exports, \"NotificationType8\", { enumerable: true, get: function () { return messages_1.NotificationType8; } });\nObject.defineProperty(exports, \"NotificationType9\", { enumerable: true, get: function () { return messages_1.NotificationType9; } });\nObject.defineProperty(exports, \"ParameterStructures\", { enumerable: true, get: function () { return messages_1.ParameterStructures; } });\nconst linkedMap_1 = require(\"./linkedMap\");\nObject.defineProperty(exports, \"LinkedMap\", { enumerable: true, get: function () { return linkedMap_1.LinkedMap; } });\nObject.defineProperty(exports, \"LRUCache\", { enumerable: true, get: function () { return linkedMap_1.LRUCache; } });\nObject.defineProperty(exports, \"Touch\", { enumerable: true, get: function () { return linkedMap_1.Touch; } });\nconst disposable_1 = require(\"./disposable\");\nObject.defineProperty(exports, \"Disposable\", { enumerable: true, get: function () { return disposable_1.Disposable; } });\nconst events_1 = require(\"./events\");\nObject.defineProperty(exports, \"Event\", { enumerable: true, get: function () { return events_1.Event; } });\nObject.defineProperty(exports, \"Emitter\", { enumerable: true, get: function () { return events_1.Emitter; } });\nconst cancellation_1 = require(\"./cancellation\");\nObject.defineProperty(exports, \"CancellationTokenSource\", { enumerable: true, get: function () { return cancellation_1.CancellationTokenSource; } });\nObject.defineProperty(exports, \"CancellationToken\", { enumerable: true, get: function () { return cancellation_1.CancellationToken; } });\nconst sharedArrayCancellation_1 = require(\"./sharedArrayCancellation\");\nObject.defineProperty(exports, \"SharedArraySenderStrategy\", { enumerable: true, get: function () { return sharedArrayCancellation_1.SharedArraySenderStrategy; } });\nObject.defineProperty(exports, \"SharedArrayReceiverStrategy\", { enumerable: true, get: function () { return sharedArrayCancellation_1.SharedArrayReceiverStrategy; } });\nconst messageReader_1 = require(\"./messageReader\");\nObject.defineProperty(exports, \"MessageReader\", { enumerable: true, get: function () { return messageReader_1.MessageReader; } });\nObject.defineProperty(exports, \"AbstractMessageReader\", { enumerable: true, get: function () { return messageReader_1.AbstractMessageReader; } });\nObject.defineProperty(exports, \"ReadableStreamMessageReader\", { enumerable: true, get: function () { return messageReader_1.ReadableStreamMessageReader; } });\nconst messageWriter_1 = require(\"./messageWriter\");\nObject.defineProperty(exports, \"MessageWriter\", { enumerable: true, get: function () { return messageWriter_1.MessageWriter; } });\nObject.defineProperty(exports, \"AbstractMessageWriter\", { enumerable: true, get: function () { return messageWriter_1.AbstractMessageWriter; } });\nObject.defineProperty(exports, \"WriteableStreamMessageWriter\", { enumerable: true, get: function () { return messageWriter_1.WriteableStreamMessageWriter; } });\nconst messageBuffer_1 = require(\"./messageBuffer\");\nObject.defineProperty(exports, \"AbstractMessageBuffer\", { enumerable: true, get: function () { return messageBuffer_1.AbstractMessageBuffer; } });\nconst connection_1 = require(\"./connection\");\nObject.defineProperty(exports, \"ConnectionStrategy\", { enumerable: true, get: function () { return connection_1.ConnectionStrategy; } });\nObject.defineProperty(exports, \"ConnectionOptions\", { enumerable: true, get: function () { return connection_1.ConnectionOptions; } });\nObject.defineProperty(exports, \"NullLogger\", { enumerable: true, get: function () { return connection_1.NullLogger; } });\nObject.defineProperty(exports, \"createMessageConnection\", { enumerable: true, get: function () { return connection_1.createMessageConnection; } });\nObject.defineProperty(exports, \"ProgressToken\", { enumerable: true, get: function () { return connection_1.ProgressToken; } });\nObject.defineProperty(exports, \"ProgressType\", { enumerable: true, get: function () { return connection_1.ProgressType; } });\nObject.defineProperty(exports, \"Trace\", { enumerable: true, get: function () { return connection_1.Trace; } });\nObject.defineProperty(exports, \"TraceValues\", { enumerable: true, get: function () { return connection_1.TraceValues; } });\nObject.defineProperty(exports, \"TraceFormat\", { enumerable: true, get: function () { return connection_1.TraceFormat; } });\nObject.defineProperty(exports, \"SetTraceNotification\", { enumerable: true, get: function () { return connection_1.SetTraceNotification; } });\nObject.defineProperty(exports, \"LogTraceNotification\", { enumerable: true, get: function () { return connection_1.LogTraceNotification; } });\nObject.defineProperty(exports, \"ConnectionErrors\", { enumerable: true, get: function () { return connection_1.ConnectionErrors; } });\nObject.defineProperty(exports, \"ConnectionError\", { enumerable: true, get: function () { return connection_1.ConnectionError; } });\nObject.defineProperty(exports, \"CancellationReceiverStrategy\", { enumerable: true, get: function () { return connection_1.CancellationReceiverStrategy; } });\nObject.defineProperty(exports, \"CancellationSenderStrategy\", { enumerable: true, get: function () { return connection_1.CancellationSenderStrategy; } });\nObject.defineProperty(exports, \"CancellationStrategy\", { enumerable: true, get: function () { return connection_1.CancellationStrategy; } });\nObject.defineProperty(exports, \"MessageStrategy\", { enumerable: true, get: function () { return connection_1.MessageStrategy; } });\nconst ral_1 = require(\"./ral\");\nexports.RAL = ral_1.default;\n","\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CancellationTokenSource = exports.CancellationToken = void 0;\nconst ral_1 = require(\"./ral\");\nconst Is = require(\"./is\");\nconst events_1 = require(\"./events\");\nvar CancellationToken;\n(function (CancellationToken) {\n    CancellationToken.None = Object.freeze({\n        isCancellationRequested: false,\n        onCancellationRequested: events_1.Event.None\n    });\n    CancellationToken.Cancelled = Object.freeze({\n        isCancellationRequested: true,\n        onCancellationRequested: events_1.Event.None\n    });\n    function is(value) {\n        const candidate = value;\n        return candidate && (candidate === CancellationToken.None\n            || candidate === CancellationToken.Cancelled\n            || (Is.boolean(candidate.isCancellationRequested) && !!candidate.onCancellationRequested));\n    }\n    CancellationToken.is = is;\n})(CancellationToken || (exports.CancellationToken = CancellationToken = {}));\nconst shortcutEvent = Object.freeze(function (callback, context) {\n    const handle = (0, ral_1.default)().timer.setTimeout(callback.bind(context), 0);\n    return { dispose() { handle.dispose(); } };\n});\nclass MutableToken {\n    constructor() {\n        this._isCancelled = false;\n    }\n    cancel() {\n        if (!this._isCancelled) {\n            this._isCancelled = true;\n            if (this._emitter) {\n                this._emitter.fire(undefined);\n                this.dispose();\n            }\n        }\n    }\n    get isCancellationRequested() {\n        return this._isCancelled;\n    }\n    get onCancellationRequested() {\n        if (this._isCancelled) {\n            return shortcutEvent;\n        }\n        if (!this._emitter) {\n            this._emitter = new events_1.Emitter();\n        }\n        return this._emitter.event;\n    }\n    dispose() {\n        if (this._emitter) {\n            this._emitter.dispose();\n            this._emitter = undefined;\n        }\n    }\n}\nclass CancellationTokenSource {\n    get token() {\n        if (!this._token) {\n            // be lazy and create the token only when\n            // actually needed\n            this._token = new MutableToken();\n        }\n        return this._token;\n    }\n    cancel() {\n        if (!this._token) {\n            // save an object by returning the default\n            // cancelled token when cancellation happens\n            // before someone asks for the token\n            this._token = CancellationToken.Cancelled;\n        }\n        else {\n            this._token.cancel();\n        }\n    }\n    dispose() {\n        if (!this._token) {\n            // ensure to initialize with an empty token if we had none\n            this._token = CancellationToken.None;\n        }\n        else if (this._token instanceof MutableToken) {\n            // actually dispose\n            this._token.dispose();\n        }\n    }\n}\nexports.CancellationTokenSource = CancellationTokenSource;\n","\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createMessageConnection = exports.ConnectionOptions = exports.MessageStrategy = exports.CancellationStrategy = exports.CancellationSenderStrategy = exports.CancellationReceiverStrategy = exports.RequestCancellationReceiverStrategy = exports.IdCancellationReceiverStrategy = exports.ConnectionStrategy = exports.ConnectionError = exports.ConnectionErrors = exports.LogTraceNotification = exports.SetTraceNotification = exports.TraceFormat = exports.TraceValues = exports.Trace = exports.NullLogger = exports.ProgressType = exports.ProgressToken = void 0;\nconst ral_1 = require(\"./ral\");\nconst Is = require(\"./is\");\nconst messages_1 = require(\"./messages\");\nconst linkedMap_1 = require(\"./linkedMap\");\nconst events_1 = require(\"./events\");\nconst cancellation_1 = require(\"./cancellation\");\nvar CancelNotification;\n(function (CancelNotification) {\n    CancelNotification.type = new messages_1.NotificationType('$/cancelRequest');\n})(CancelNotification || (CancelNotification = {}));\nvar ProgressToken;\n(function (ProgressToken) {\n    function is(value) {\n        return typeof value === 'string' || typeof value === 'number';\n    }\n    ProgressToken.is = is;\n})(ProgressToken || (exports.ProgressToken = ProgressToken = {}));\nvar ProgressNotification;\n(function (ProgressNotification) {\n    ProgressNotification.type = new messages_1.NotificationType('$/progress');\n})(ProgressNotification || (ProgressNotification = {}));\nclass ProgressType {\n    constructor() {\n    }\n}\nexports.ProgressType = ProgressType;\nvar StarRequestHandler;\n(function (StarRequestHandler) {\n    function is(value) {\n        return Is.func(value);\n    }\n    StarRequestHandler.is = is;\n})(StarRequestHandler || (StarRequestHandler = {}));\nexports.NullLogger = Object.freeze({\n    error: () => { },\n    warn: () => { },\n    info: () => { },\n    log: () => { }\n});\nvar Trace;\n(function (Trace) {\n    Trace[Trace[\"Off\"] = 0] = \"Off\";\n    Trace[Trace[\"Messages\"] = 1] = \"Messages\";\n    Trace[Trace[\"Compact\"] = 2] = \"Compact\";\n    Trace[Trace[\"Verbose\"] = 3] = \"Verbose\";\n})(Trace || (exports.Trace = Trace = {}));\nvar TraceValues;\n(function (TraceValues) {\n    /**\n     * Turn tracing off.\n     */\n    TraceValues.Off = 'off';\n    /**\n     * Trace messages only.\n     */\n    TraceValues.Messages = 'messages';\n    /**\n     * Compact message tracing.\n     */\n    TraceValues.Compact = 'compact';\n    /**\n     * Verbose message tracing.\n     */\n    TraceValues.Verbose = 'verbose';\n})(TraceValues || (exports.TraceValues = TraceValues = {}));\n(function (Trace) {\n    function fromString(value) {\n        if (!Is.string(value)) {\n            return Trace.Off;\n        }\n        value = value.toLowerCase();\n        switch (value) {\n            case 'off':\n                return Trace.Off;\n            case 'messages':\n                return Trace.Messages;\n            case 'compact':\n                return Trace.Compact;\n            case 'verbose':\n                return Trace.Verbose;\n            default:\n                return Trace.Off;\n        }\n    }\n    Trace.fromString = fromString;\n    function toString(value) {\n        switch (value) {\n            case Trace.Off:\n                return 'off';\n            case Trace.Messages:\n                return 'messages';\n            case Trace.Compact:\n                return 'compact';\n            case Trace.Verbose:\n                return 'verbose';\n            default:\n                return 'off';\n        }\n    }\n    Trace.toString = toString;\n})(Trace || (exports.Trace = Trace = {}));\nvar TraceFormat;\n(function (TraceFormat) {\n    TraceFormat[\"Text\"] = \"text\";\n    TraceFormat[\"JSON\"] = \"json\";\n})(TraceFormat || (exports.TraceFormat = TraceFormat = {}));\n(function (TraceFormat) {\n    function fromString(value) {\n        if (!Is.string(value)) {\n            return TraceFormat.Text;\n        }\n        value = value.toLowerCase();\n        if (value === 'json') {\n            return TraceFormat.JSON;\n        }\n        else {\n            return TraceFormat.Text;\n        }\n    }\n    TraceFormat.fromString = fromString;\n})(TraceFormat || (exports.TraceFormat = TraceFormat = {}));\nvar SetTraceNotification;\n(function (SetTraceNotification) {\n    SetTraceNotification.type = new messages_1.NotificationType('$/setTrace');\n})(SetTraceNotification || (exports.SetTraceNotification = SetTraceNotification = {}));\nvar LogTraceNotification;\n(function (LogTraceNotification) {\n    LogTraceNotification.type = new messages_1.NotificationType('$/logTrace');\n})(LogTraceNotification || (exports.LogTraceNotification = LogTraceNotification = {}));\nvar ConnectionErrors;\n(function (ConnectionErrors) {\n    /**\n     * The connection is closed.\n     */\n    ConnectionErrors[ConnectionErrors[\"Closed\"] = 1] = \"Closed\";\n    /**\n     * The connection got disposed.\n     */\n    ConnectionErrors[ConnectionErrors[\"Disposed\"] = 2] = \"Disposed\";\n    /**\n     * The connection is already in listening mode.\n     */\n    ConnectionErrors[ConnectionErrors[\"AlreadyListening\"] = 3] = \"AlreadyListening\";\n})(ConnectionErrors || (exports.ConnectionErrors = ConnectionErrors = {}));\nclass ConnectionError extends Error {\n    constructor(code, message) {\n        super(message);\n        this.code = code;\n        Object.setPrototypeOf(this, ConnectionError.prototype);\n    }\n}\nexports.ConnectionError = ConnectionError;\nvar ConnectionStrategy;\n(function (ConnectionStrategy) {\n    function is(value) {\n        const candidate = value;\n        return candidate && Is.func(candidate.cancelUndispatched);\n    }\n    ConnectionStrategy.is = is;\n})(ConnectionStrategy || (exports.ConnectionStrategy = ConnectionStrategy = {}));\nvar IdCancellationReceiverStrategy;\n(function (IdCancellationReceiverStrategy) {\n    function is(value) {\n        const candidate = value;\n        return candidate && (candidate.kind === undefined || candidate.kind === 'id') && Is.func(candidate.createCancellationTokenSource) && (candidate.dispose === undefined || Is.func(candidate.dispose));\n    }\n    IdCancellationReceiverStrategy.is = is;\n})(IdCancellationReceiverStrategy || (exports.IdCancellationReceiverStrategy = IdCancellationReceiverStrategy = {}));\nvar RequestCancellationReceiverStrategy;\n(function (RequestCancellationReceiverStrategy) {\n    function is(value) {\n        const candidate = value;\n        return candidate && candidate.kind === 'request' && Is.func(candidate.createCancellationTokenSource) && (candidate.dispose === undefined || Is.func(candidate.dispose));\n    }\n    RequestCancellationReceiverStrategy.is = is;\n})(RequestCancellationReceiverStrategy || (exports.RequestCancellationReceiverStrategy = RequestCancellationReceiverStrategy = {}));\nvar CancellationReceiverStrategy;\n(function (CancellationReceiverStrategy) {\n    CancellationReceiverStrategy.Message = Object.freeze({\n        createCancellationTokenSource(_) {\n            return new cancellation_1.CancellationTokenSource();\n        }\n    });\n    function is(value) {\n        return IdCancellationReceiverStrategy.is(value) || RequestCancellationReceiverStrategy.is(value);\n    }\n    CancellationReceiverStrategy.is = is;\n})(CancellationReceiverStrategy || (exports.CancellationReceiverStrategy = CancellationReceiverStrategy = {}));\nvar CancellationSenderStrategy;\n(function (CancellationSenderStrategy) {\n    CancellationSenderStrategy.Message = Object.freeze({\n        sendCancellation(conn, id) {\n            return conn.sendNotification(CancelNotification.type, { id });\n        },\n        cleanup(_) { }\n    });\n    function is(value) {\n        const candidate = value;\n        return candidate && Is.func(candidate.sendCancellation) && Is.func(candidate.cleanup);\n    }\n    CancellationSenderStrategy.is = is;\n})(CancellationSenderStrategy || (exports.CancellationSenderStrategy = CancellationSenderStrategy = {}));\nvar CancellationStrategy;\n(function (CancellationStrategy) {\n    CancellationStrategy.Message = Object.freeze({\n        receiver: CancellationReceiverStrategy.Message,\n        sender: CancellationSenderStrategy.Message\n    });\n    function is(value) {\n        const candidate = value;\n        return candidate && CancellationReceiverStrategy.is(candidate.receiver) && CancellationSenderStrategy.is(candidate.sender);\n    }\n    CancellationStrategy.is = is;\n})(CancellationStrategy || (exports.CancellationStrategy = CancellationStrategy = {}));\nvar MessageStrategy;\n(function (MessageStrategy) {\n    function is(value) {\n        const candidate = value;\n        return candidate && Is.func(candidate.handleMessage);\n    }\n    MessageStrategy.is = is;\n})(MessageStrategy || (exports.MessageStrategy = MessageStrategy = {}));\nvar ConnectionOptions;\n(function (ConnectionOptions) {\n    function is(value) {\n        const candidate = value;\n        return candidate && (CancellationStrategy.is(candidate.cancellationStrategy) || ConnectionStrategy.is(candidate.connectionStrategy) || MessageStrategy.is(candidate.messageStrategy));\n    }\n    ConnectionOptions.is = is;\n})(ConnectionOptions || (exports.ConnectionOptions = ConnectionOptions = {}));\nvar ConnectionState;\n(function (ConnectionState) {\n    ConnectionState[ConnectionState[\"New\"] = 1] = \"New\";\n    ConnectionState[ConnectionState[\"Listening\"] = 2] = \"Listening\";\n    ConnectionState[ConnectionState[\"Closed\"] = 3] = \"Closed\";\n    ConnectionState[ConnectionState[\"Disposed\"] = 4] = \"Disposed\";\n})(ConnectionState || (ConnectionState = {}));\nfunction createMessageConnection(messageReader, messageWriter, _logger, options) {\n    const logger = _logger !== undefined ? _logger : exports.NullLogger;\n    let sequenceNumber = 0;\n    let notificationSequenceNumber = 0;\n    let unknownResponseSequenceNumber = 0;\n    const version = '2.0';\n    let starRequestHandler = undefined;\n    const requestHandlers = new Map();\n    let starNotificationHandler = undefined;\n    const notificationHandlers = new Map();\n    const progressHandlers = new Map();\n    let timer;\n    let messageQueue = new linkedMap_1.LinkedMap();\n    let responsePromises = new Map();\n    let knownCanceledRequests = new Set();\n    let requestTokens = new Map();\n    let trace = Trace.Off;\n    let traceFormat = TraceFormat.Text;\n    let tracer;\n    let state = ConnectionState.New;\n    const errorEmitter = new events_1.Emitter();\n    const closeEmitter = new events_1.Emitter();\n    const unhandledNotificationEmitter = new events_1.Emitter();\n    const unhandledProgressEmitter = new events_1.Emitter();\n    const disposeEmitter = new events_1.Emitter();\n    const cancellationStrategy = (options && options.cancellationStrategy) ? options.cancellationStrategy : CancellationStrategy.Message;\n    function createRequestQueueKey(id) {\n        if (id === null) {\n            throw new Error(`Can't send requests with id null since the response can't be correlated.`);\n        }\n        return 'req-' + id.toString();\n    }\n    function createResponseQueueKey(id) {\n        if (id === null) {\n            return 'res-unknown-' + (++unknownResponseSequenceNumber).toString();\n        }\n        else {\n            return 'res-' + id.toString();\n        }\n    }\n    function createNotificationQueueKey() {\n        return 'not-' + (++notificationSequenceNumber).toString();\n    }\n    function addMessageToQueue(queue, message) {\n        if (messages_1.Message.isRequest(message)) {\n            queue.set(createRequestQueueKey(message.id), message);\n        }\n        else if (messages_1.Message.isResponse(message)) {\n            queue.set(createResponseQueueKey(message.id), message);\n        }\n        else {\n            queue.set(createNotificationQueueKey(), message);\n        }\n    }\n    function cancelUndispatched(_message) {\n        return undefined;\n    }\n    function isListening() {\n        return state === ConnectionState.Listening;\n    }\n    function isClosed() {\n        return state === ConnectionState.Closed;\n    }\n    function isDisposed() {\n        return state === ConnectionState.Disposed;\n    }\n    function closeHandler() {\n        if (state === ConnectionState.New || state === ConnectionState.Listening) {\n            state = ConnectionState.Closed;\n            closeEmitter.fire(undefined);\n        }\n        // If the connection is disposed don't sent close events.\n    }\n    function readErrorHandler(error) {\n        errorEmitter.fire([error, undefined, undefined]);\n    }\n    function writeErrorHandler(data) {\n        errorEmitter.fire(data);\n    }\n    messageReader.onClose(closeHandler);\n    messageReader.onError(readErrorHandler);\n    messageWriter.onClose(closeHandler);\n    messageWriter.onError(writeErrorHandler);\n    function triggerMessageQueue() {\n        if (timer || messageQueue.size === 0) {\n            return;\n        }\n        timer = (0, ral_1.default)().timer.setImmediate(() => {\n            timer = undefined;\n            processMessageQueue();\n        });\n    }\n    function handleMessage(message) {\n        if (messages_1.Message.isRequest(message)) {\n            handleRequest(message);\n        }\n        else if (messages_1.Message.isNotification(message)) {\n            handleNotification(message);\n        }\n        else if (messages_1.Message.isResponse(message)) {\n            handleResponse(message);\n        }\n        else {\n            handleInvalidMessage(message);\n        }\n    }\n    function processMessageQueue() {\n        if (messageQueue.size === 0) {\n            return;\n        }\n        const message = messageQueue.shift();\n        try {\n            const messageStrategy = options?.messageStrategy;\n            if (MessageStrategy.is(messageStrategy)) {\n                messageStrategy.handleMessage(message, handleMessage);\n            }\n            else {\n                handleMessage(message);\n            }\n        }\n        finally {\n            triggerMessageQueue();\n        }\n    }\n    const callback = (message) => {\n        try {\n            // We have received a cancellation message. Check if the message is still in the queue\n            // and cancel it if allowed to do so.\n            if (messages_1.Message.isNotification(message) && message.method === CancelNotification.type.method) {\n                const cancelId = message.params.id;\n                const key = createRequestQueueKey(cancelId);\n                const toCancel = messageQueue.get(key);\n                if (messages_1.Message.isRequest(toCancel)) {\n                    const strategy = options?.connectionStrategy;\n                    const response = (strategy && strategy.cancelUndispatched) ? strategy.cancelUndispatched(toCancel, cancelUndispatched) : cancelUndispatched(toCancel);\n                    if (response && (response.error !== undefined || response.result !== undefined)) {\n                        messageQueue.delete(key);\n                        requestTokens.delete(cancelId);\n                        response.id = toCancel.id;\n                        traceSendingResponse(response, message.method, Date.now());\n                        messageWriter.write(response).catch(() => logger.error(`Sending response for canceled message failed.`));\n                        return;\n                    }\n                }\n                const cancellationToken = requestTokens.get(cancelId);\n                // The request is already running. Cancel the token\n                if (cancellationToken !== undefined) {\n                    cancellationToken.cancel();\n                    traceReceivedNotification(message);\n                    return;\n                }\n                else {\n                    // Remember the cancel but still queue the message to\n                    // clean up state in process message.\n                    knownCanceledRequests.add(cancelId);\n                }\n            }\n            addMessageToQueue(messageQueue, message);\n        }\n        finally {\n            triggerMessageQueue();\n        }\n    };\n    function handleRequest(requestMessage) {\n        if (isDisposed()) {\n            // we return here silently since we fired an event when the\n            // connection got disposed.\n            return;\n        }\n        function reply(resultOrError, method, startTime) {\n            const message = {\n                jsonrpc: version,\n                id: requestMessage.id\n            };\n            if (resultOrError instanceof messages_1.ResponseError) {\n                message.error = resultOrError.toJson();\n            }\n            else {\n                message.result = resultOrError === undefined ? null : resultOrError;\n            }\n            traceSendingResponse(message, method, startTime);\n            messageWriter.write(message).catch(() => logger.error(`Sending response failed.`));\n        }\n        function replyError(error, method, startTime) {\n            const message = {\n                jsonrpc: version,\n                id: requestMessage.id,\n                error: error.toJson()\n            };\n            traceSendingResponse(message, method, startTime);\n            messageWriter.write(message).catch(() => logger.error(`Sending response failed.`));\n        }\n        function replySuccess(result, method, startTime) {\n            // The JSON RPC defines that a response must either have a result or an error\n            // So we can't treat undefined as a valid response result.\n            if (result === undefined) {\n                result = null;\n            }\n            const message = {\n                jsonrpc: version,\n                id: requestMessage.id,\n                result: result\n            };\n            traceSendingResponse(message, method, startTime);\n            messageWriter.write(message).catch(() => logger.error(`Sending response failed.`));\n        }\n        traceReceivedRequest(requestMessage);\n        const element = requestHandlers.get(requestMessage.method);\n        let type;\n        let requestHandler;\n        if (element) {\n            type = element.type;\n            requestHandler = element.handler;\n        }\n        const startTime = Date.now();\n        if (requestHandler || starRequestHandler) {\n            const tokenKey = requestMessage.id ?? String(Date.now()); //\n            const cancellationSource = IdCancellationReceiverStrategy.is(cancellationStrategy.receiver)\n                ? cancellationStrategy.receiver.createCancellationTokenSource(tokenKey)\n                : cancellationStrategy.receiver.createCancellationTokenSource(requestMessage);\n            if (requestMessage.id !== null && knownCanceledRequests.has(requestMessage.id)) {\n                cancellationSource.cancel();\n            }\n            if (requestMessage.id !== null) {\n                requestTokens.set(tokenKey, cancellationSource);\n            }\n            try {\n                let handlerResult;\n                if (requestHandler) {\n                    if (requestMessage.params === undefined) {\n                        if (type !== undefined && type.numberOfParams !== 0) {\n                            replyError(new messages_1.ResponseError(messages_1.ErrorCodes.InvalidParams, `Request ${requestMessage.method} defines ${type.numberOfParams} params but received none.`), requestMessage.method, startTime);\n                            return;\n                        }\n                        handlerResult = requestHandler(cancellationSource.token);\n                    }\n                    else if (Array.isArray(requestMessage.params)) {\n                        if (type !== undefined && type.parameterStructures === messages_1.ParameterStructures.byName) {\n                            replyError(new messages_1.ResponseError(messages_1.ErrorCodes.InvalidParams, `Request ${requestMessage.method} defines parameters by name but received parameters by position`), requestMessage.method, startTime);\n                            return;\n                        }\n                        handlerResult = requestHandler(...requestMessage.params, cancellationSource.token);\n                    }\n                    else {\n                        if (type !== undefined && type.parameterStructures === messages_1.ParameterStructures.byPosition) {\n                            replyError(new messages_1.ResponseError(messages_1.ErrorCodes.InvalidParams, `Request ${requestMessage.method} defines parameters by position but received parameters by name`), requestMessage.method, startTime);\n                            return;\n                        }\n                        handlerResult = requestHandler(requestMessage.params, cancellationSource.token);\n                    }\n                }\n                else if (starRequestHandler) {\n                    handlerResult = starRequestHandler(requestMessage.method, requestMessage.params, cancellationSource.token);\n                }\n                const promise = handlerResult;\n                if (!handlerResult) {\n                    requestTokens.delete(tokenKey);\n                    replySuccess(handlerResult, requestMessage.method, startTime);\n                }\n                else if (promise.then) {\n                    promise.then((resultOrError) => {\n                        requestTokens.delete(tokenKey);\n                        reply(resultOrError, requestMessage.method, startTime);\n                    }, error => {\n                        requestTokens.delete(tokenKey);\n                        if (error instanceof messages_1.ResponseError) {\n                            replyError(error, requestMessage.method, startTime);\n                        }\n                        else if (error && Is.string(error.message)) {\n                            replyError(new messages_1.ResponseError(messages_1.ErrorCodes.InternalError, `Request ${requestMessage.method} failed with message: ${error.message}`), requestMessage.method, startTime);\n                        }\n                        else {\n                            replyError(new messages_1.ResponseError(messages_1.ErrorCodes.InternalError, `Request ${requestMessage.method} failed unexpectedly without providing any details.`), requestMessage.method, startTime);\n                        }\n                    });\n                }\n                else {\n                    requestTokens.delete(tokenKey);\n                    reply(handlerResult, requestMessage.method, startTime);\n                }\n            }\n            catch (error) {\n                requestTokens.delete(tokenKey);\n                if (error instanceof messages_1.ResponseError) {\n                    reply(error, requestMessage.method, startTime);\n                }\n                else if (error && Is.string(error.message)) {\n                    replyError(new messages_1.ResponseError(messages_1.ErrorCodes.InternalError, `Request ${requestMessage.method} failed with message: ${error.message}`), requestMessage.method, startTime);\n                }\n                else {\n                    replyError(new messages_1.ResponseError(messages_1.ErrorCodes.InternalError, `Request ${requestMessage.method} failed unexpectedly without providing any details.`), requestMessage.method, startTime);\n                }\n            }\n        }\n        else {\n            replyError(new messages_1.ResponseError(messages_1.ErrorCodes.MethodNotFound, `Unhandled method ${requestMessage.method}`), requestMessage.method, startTime);\n        }\n    }\n    function handleResponse(responseMessage) {\n        if (isDisposed()) {\n            // See handle request.\n            return;\n        }\n        if (responseMessage.id === null) {\n            if (responseMessage.error) {\n                logger.error(`Received response message without id: Error is: \\n${JSON.stringify(responseMessage.error, undefined, 4)}`);\n            }\n            else {\n                logger.error(`Received response message without id. No further error information provided.`);\n            }\n        }\n        else {\n            const key = responseMessage.id;\n            const responsePromise = responsePromises.get(key);\n            traceReceivedResponse(responseMessage, responsePromise);\n            if (responsePromise !== undefined) {\n                responsePromises.delete(key);\n                try {\n                    if (responseMessage.error) {\n                        const error = responseMessage.error;\n                        responsePromise.reject(new messages_1.ResponseError(error.code, error.message, error.data));\n                    }\n                    else if (responseMessage.result !== undefined) {\n                        responsePromise.resolve(responseMessage.result);\n                    }\n                    else {\n                        throw new Error('Should never happen.');\n                    }\n                }\n                catch (error) {\n                    if (error.message) {\n                        logger.error(`Response handler '${responsePromise.method}' failed with message: ${error.message}`);\n                    }\n                    else {\n                        logger.error(`Response handler '${responsePromise.method}' failed unexpectedly.`);\n                    }\n                }\n            }\n        }\n    }\n    function handleNotification(message) {\n        if (isDisposed()) {\n            // See handle request.\n            return;\n        }\n        let type = undefined;\n        let notificationHandler;\n        if (message.method === CancelNotification.type.method) {\n            const cancelId = message.params.id;\n            knownCanceledRequests.delete(cancelId);\n            traceReceivedNotification(message);\n            return;\n        }\n        else {\n            const element = notificationHandlers.get(message.method);\n            if (element) {\n                notificationHandler = element.handler;\n                type = element.type;\n            }\n        }\n        if (notificationHandler || starNotificationHandler) {\n            try {\n                traceReceivedNotification(message);\n                if (notificationHandler) {\n                    if (message.params === undefined) {\n                        if (type !== undefined) {\n                            if (type.numberOfParams !== 0 && type.parameterStructures !== messages_1.ParameterStructures.byName) {\n                                logger.error(`Notification ${message.method} defines ${type.numberOfParams} params but received none.`);\n                            }\n                        }\n                        notificationHandler();\n                    }\n                    else if (Array.isArray(message.params)) {\n                        // There are JSON-RPC libraries that send progress message as positional params although\n                        // specified as named. So convert them if this is the case.\n                        const params = message.params;\n                        if (message.method === ProgressNotification.type.method && params.length === 2 && ProgressToken.is(params[0])) {\n                            notificationHandler({ token: params[0], value: params[1] });\n                        }\n                        else {\n                            if (type !== undefined) {\n                                if (type.parameterStructures === messages_1.ParameterStructures.byName) {\n                                    logger.error(`Notification ${message.method} defines parameters by name but received parameters by position`);\n                                }\n                                if (type.numberOfParams !== message.params.length) {\n                                    logger.error(`Notification ${message.method} defines ${type.numberOfParams} params but received ${params.length} arguments`);\n                                }\n                            }\n                            notificationHandler(...params);\n                        }\n                    }\n                    else {\n                        if (type !== undefined && type.parameterStructures === messages_1.ParameterStructures.byPosition) {\n                            logger.error(`Notification ${message.method} defines parameters by position but received parameters by name`);\n                        }\n                        notificationHandler(message.params);\n                    }\n                }\n                else if (starNotificationHandler) {\n                    starNotificationHandler(message.method, message.params);\n                }\n            }\n            catch (error) {\n                if (error.message) {\n                    logger.error(`Notification handler '${message.method}' failed with message: ${error.message}`);\n                }\n                else {\n                    logger.error(`Notification handler '${message.method}' failed unexpectedly.`);\n                }\n            }\n        }\n        else {\n            unhandledNotificationEmitter.fire(message);\n        }\n    }\n    function handleInvalidMessage(message) {\n        if (!message) {\n            logger.error('Received empty message.');\n            return;\n        }\n        logger.error(`Received message which is neither a response nor a notification message:\\n${JSON.stringify(message, null, 4)}`);\n        // Test whether we find an id to reject the promise\n        const responseMessage = message;\n        if (Is.string(responseMessage.id) || Is.number(responseMessage.id)) {\n            const key = responseMessage.id;\n            const responseHandler = responsePromises.get(key);\n            if (responseHandler) {\n                responseHandler.reject(new Error('The received response has neither a result nor an error property.'));\n            }\n        }\n    }\n    function stringifyTrace(params) {\n        if (params === undefined || params === null) {\n            return undefined;\n        }\n        switch (trace) {\n            case Trace.Verbose:\n                return JSON.stringify(params, null, 4);\n            case Trace.Compact:\n                return JSON.stringify(params);\n            default:\n                return undefined;\n        }\n    }\n    function traceSendingRequest(message) {\n        if (trace === Trace.Off || !tracer) {\n            return;\n        }\n        if (traceFormat === TraceFormat.Text) {\n            let data = undefined;\n            if ((trace === Trace.Verbose || trace === Trace.Compact) && message.params) {\n                data = `Params: ${stringifyTrace(message.params)}\\n\\n`;\n            }\n            tracer.log(`Sending request '${message.method} - (${message.id})'.`, data);\n        }\n        else {\n            logLSPMessage('send-request', message);\n        }\n    }\n    function traceSendingNotification(message) {\n        if (trace === Trace.Off || !tracer) {\n            return;\n        }\n        if (traceFormat === TraceFormat.Text) {\n            let data = undefined;\n            if (trace === Trace.Verbose || trace === Trace.Compact) {\n                if (message.params) {\n                    data = `Params: ${stringifyTrace(message.params)}\\n\\n`;\n                }\n                else {\n                    data = 'No parameters provided.\\n\\n';\n                }\n            }\n            tracer.log(`Sending notification '${message.method}'.`, data);\n        }\n        else {\n            logLSPMessage('send-notification', message);\n        }\n    }\n    function traceSendingResponse(message, method, startTime) {\n        if (trace === Trace.Off || !tracer) {\n            return;\n        }\n        if (traceFormat === TraceFormat.Text) {\n            let data = undefined;\n            if (trace === Trace.Verbose || trace === Trace.Compact) {\n                if (message.error && message.error.data) {\n                    data = `Error data: ${stringifyTrace(message.error.data)}\\n\\n`;\n                }\n                else {\n                    if (message.result) {\n                        data = `Result: ${stringifyTrace(message.result)}\\n\\n`;\n                    }\n                    else if (message.error === undefined) {\n                        data = 'No result returned.\\n\\n';\n                    }\n                }\n            }\n            tracer.log(`Sending response '${method} - (${message.id})'. Processing request took ${Date.now() - startTime}ms`, data);\n        }\n        else {\n            logLSPMessage('send-response', message);\n        }\n    }\n    function traceReceivedRequest(message) {\n        if (trace === Trace.Off || !tracer) {\n            return;\n        }\n        if (traceFormat === TraceFormat.Text) {\n            let data = undefined;\n            if ((trace === Trace.Verbose || trace === Trace.Compact) && message.params) {\n                data = `Params: ${stringifyTrace(message.params)}\\n\\n`;\n            }\n            tracer.log(`Received request '${message.method} - (${message.id})'.`, data);\n        }\n        else {\n            logLSPMessage('receive-request', message);\n        }\n    }\n    function traceReceivedNotification(message) {\n        if (trace === Trace.Off || !tracer || message.method === LogTraceNotification.type.method) {\n            return;\n        }\n        if (traceFormat === TraceFormat.Text) {\n            let data = undefined;\n            if (trace === Trace.Verbose || trace === Trace.Compact) {\n                if (message.params) {\n                    data = `Params: ${stringifyTrace(message.params)}\\n\\n`;\n                }\n                else {\n                    data = 'No parameters provided.\\n\\n';\n                }\n            }\n            tracer.log(`Received notification '${message.method}'.`, data);\n        }\n        else {\n            logLSPMessage('receive-notification', message);\n        }\n    }\n    function traceReceivedResponse(message, responsePromise) {\n        if (trace === Trace.Off || !tracer) {\n            return;\n        }\n        if (traceFormat === TraceFormat.Text) {\n            let data = undefined;\n            if (trace === Trace.Verbose || trace === Trace.Compact) {\n                if (message.error && message.error.data) {\n                    data = `Error data: ${stringifyTrace(message.error.data)}\\n\\n`;\n                }\n                else {\n                    if (message.result) {\n                        data = `Result: ${stringifyTrace(message.result)}\\n\\n`;\n                    }\n                    else if (message.error === undefined) {\n                        data = 'No result returned.\\n\\n';\n                    }\n                }\n            }\n            if (responsePromise) {\n                const error = message.error ? ` Request failed: ${message.error.message} (${message.error.code}).` : '';\n                tracer.log(`Received response '${responsePromise.method} - (${message.id})' in ${Date.now() - responsePromise.timerStart}ms.${error}`, data);\n            }\n            else {\n                tracer.log(`Received response ${message.id} without active response promise.`, data);\n            }\n        }\n        else {\n            logLSPMessage('receive-response', message);\n        }\n    }\n    function logLSPMessage(type, message) {\n        if (!tracer || trace === Trace.Off) {\n            return;\n        }\n        const lspMessage = {\n            isLSPMessage: true,\n            type,\n            message,\n            timestamp: Date.now()\n        };\n        tracer.log(lspMessage);\n    }\n    function throwIfClosedOrDisposed() {\n        if (isClosed()) {\n            throw new ConnectionError(ConnectionErrors.Closed, 'Connection is closed.');\n        }\n        if (isDisposed()) {\n            throw new ConnectionError(ConnectionErrors.Disposed, 'Connection is disposed.');\n        }\n    }\n    function throwIfListening() {\n        if (isListening()) {\n            throw new ConnectionError(ConnectionErrors.AlreadyListening, 'Connection is already listening');\n        }\n    }\n    function throwIfNotListening() {\n        if (!isListening()) {\n            throw new Error('Call listen() first.');\n        }\n    }\n    function undefinedToNull(param) {\n        if (param === undefined) {\n            return null;\n        }\n        else {\n            return param;\n        }\n    }\n    function nullToUndefined(param) {\n        if (param === null) {\n            return undefined;\n        }\n        else {\n            return param;\n        }\n    }\n    function isNamedParam(param) {\n        return param !== undefined && param !== null && !Array.isArray(param) && typeof param === 'object';\n    }\n    function computeSingleParam(parameterStructures, param) {\n        switch (parameterStructures) {\n            case messages_1.ParameterStructures.auto:\n                if (isNamedParam(param)) {\n                    return nullToUndefined(param);\n                }\n                else {\n                    return [undefinedToNull(param)];\n                }\n            case messages_1.ParameterStructures.byName:\n                if (!isNamedParam(param)) {\n                    throw new Error(`Received parameters by name but param is not an object literal.`);\n                }\n                return nullToUndefined(param);\n            case messages_1.ParameterStructures.byPosition:\n                return [undefinedToNull(param)];\n            default:\n                throw new Error(`Unknown parameter structure ${parameterStructures.toString()}`);\n        }\n    }\n    function computeMessageParams(type, params) {\n        let result;\n        const numberOfParams = type.numberOfParams;\n        switch (numberOfParams) {\n            case 0:\n                result = undefined;\n                break;\n            case 1:\n                result = computeSingleParam(type.parameterStructures, params[0]);\n                break;\n            default:\n                result = [];\n                for (let i = 0; i < params.length && i < numberOfParams; i++) {\n                    result.push(undefinedToNull(params[i]));\n                }\n                if (params.length < numberOfParams) {\n                    for (let i = params.length; i < numberOfParams; i++) {\n                        result.push(null);\n                    }\n                }\n                break;\n        }\n        return result;\n    }\n    const connection = {\n        sendNotification: (type, ...args) => {\n            throwIfClosedOrDisposed();\n            let method;\n            let messageParams;\n            if (Is.string(type)) {\n                method = type;\n                const first = args[0];\n                let paramStart = 0;\n                let parameterStructures = messages_1.ParameterStructures.auto;\n                if (messages_1.ParameterStructures.is(first)) {\n                    paramStart = 1;\n                    parameterStructures = first;\n                }\n                let paramEnd = args.length;\n                const numberOfParams = paramEnd - paramStart;\n                switch (numberOfParams) {\n                    case 0:\n                        messageParams = undefined;\n                        break;\n                    case 1:\n                        messageParams = computeSingleParam(parameterStructures, args[paramStart]);\n                        break;\n                    default:\n                        if (parameterStructures === messages_1.ParameterStructures.byName) {\n                            throw new Error(`Received ${numberOfParams} parameters for 'by Name' notification parameter structure.`);\n                        }\n                        messageParams = args.slice(paramStart, paramEnd).map(value => undefinedToNull(value));\n                        break;\n                }\n            }\n            else {\n                const params = args;\n                method = type.method;\n                messageParams = computeMessageParams(type, params);\n            }\n            const notificationMessage = {\n                jsonrpc: version,\n                method: method,\n                params: messageParams\n            };\n            traceSendingNotification(notificationMessage);\n            return messageWriter.write(notificationMessage).catch((error) => {\n                logger.error(`Sending notification failed.`);\n                throw error;\n            });\n        },\n        onNotification: (type, handler) => {\n            throwIfClosedOrDisposed();\n            let method;\n            if (Is.func(type)) {\n                starNotificationHandler = type;\n            }\n            else if (handler) {\n                if (Is.string(type)) {\n                    method = type;\n                    notificationHandlers.set(type, { type: undefined, handler });\n                }\n                else {\n                    method = type.method;\n                    notificationHandlers.set(type.method, { type, handler });\n                }\n            }\n            return {\n                dispose: () => {\n                    if (method !== undefined) {\n                        notificationHandlers.delete(method);\n                    }\n                    else {\n                        starNotificationHandler = undefined;\n                    }\n                }\n            };\n        },\n        onProgress: (_type, token, handler) => {\n            if (progressHandlers.has(token)) {\n                throw new Error(`Progress handler for token ${token} already registered`);\n            }\n            progressHandlers.set(token, handler);\n            return {\n                dispose: () => {\n                    progressHandlers.delete(token);\n                }\n            };\n        },\n        sendProgress: (_type, token, value) => {\n            // This should not await but simple return to ensure that we don't have another\n            // async scheduling. Otherwise one send could overtake another send.\n            return connection.sendNotification(ProgressNotification.type, { token, value });\n        },\n        onUnhandledProgress: unhandledProgressEmitter.event,\n        sendRequest: (type, ...args) => {\n            throwIfClosedOrDisposed();\n            throwIfNotListening();\n            let method;\n            let messageParams;\n            let token = undefined;\n            if (Is.string(type)) {\n                method = type;\n                const first = args[0];\n                const last = args[args.length - 1];\n                let paramStart = 0;\n                let parameterStructures = messages_1.ParameterStructures.auto;\n                if (messages_1.ParameterStructures.is(first)) {\n                    paramStart = 1;\n                    parameterStructures = first;\n                }\n                let paramEnd = args.length;\n                if (cancellation_1.CancellationToken.is(last)) {\n                    paramEnd = paramEnd - 1;\n                    token = last;\n                }\n                const numberOfParams = paramEnd - paramStart;\n                switch (numberOfParams) {\n                    case 0:\n                        messageParams = undefined;\n                        break;\n                    case 1:\n                        messageParams = computeSingleParam(parameterStructures, args[paramStart]);\n                        break;\n                    default:\n                        if (parameterStructures === messages_1.ParameterStructures.byName) {\n                            throw new Error(`Received ${numberOfParams} parameters for 'by Name' request parameter structure.`);\n                        }\n                        messageParams = args.slice(paramStart, paramEnd).map(value => undefinedToNull(value));\n                        break;\n                }\n            }\n            else {\n                const params = args;\n                method = type.method;\n                messageParams = computeMessageParams(type, params);\n                const numberOfParams = type.numberOfParams;\n                token = cancellation_1.CancellationToken.is(params[numberOfParams]) ? params[numberOfParams] : undefined;\n            }\n            const id = sequenceNumber++;\n            let disposable;\n            if (token) {\n                disposable = token.onCancellationRequested(() => {\n                    const p = cancellationStrategy.sender.sendCancellation(connection, id);\n                    if (p === undefined) {\n                        logger.log(`Received no promise from cancellation strategy when cancelling id ${id}`);\n                        return Promise.resolve();\n                    }\n                    else {\n                        return p.catch(() => {\n                            logger.log(`Sending cancellation messages for id ${id} failed`);\n                        });\n                    }\n                });\n            }\n            const requestMessage = {\n                jsonrpc: version,\n                id: id,\n                method: method,\n                params: messageParams\n            };\n            traceSendingRequest(requestMessage);\n            if (typeof cancellationStrategy.sender.enableCancellation === 'function') {\n                cancellationStrategy.sender.enableCancellation(requestMessage);\n            }\n            return new Promise(async (resolve, reject) => {\n                const resolveWithCleanup = (r) => {\n                    resolve(r);\n                    cancellationStrategy.sender.cleanup(id);\n                    disposable?.dispose();\n                };\n                const rejectWithCleanup = (r) => {\n                    reject(r);\n                    cancellationStrategy.sender.cleanup(id);\n                    disposable?.dispose();\n                };\n                const responsePromise = { method: method, timerStart: Date.now(), resolve: resolveWithCleanup, reject: rejectWithCleanup };\n                try {\n                    await messageWriter.write(requestMessage);\n                    responsePromises.set(id, responsePromise);\n                }\n                catch (error) {\n                    logger.error(`Sending request failed.`);\n                    // Writing the message failed. So we need to reject the promise.\n                    responsePromise.reject(new messages_1.ResponseError(messages_1.ErrorCodes.MessageWriteError, error.message ? error.message : 'Unknown reason'));\n                    throw error;\n                }\n            });\n        },\n        onRequest: (type, handler) => {\n            throwIfClosedOrDisposed();\n            let method = null;\n            if (StarRequestHandler.is(type)) {\n                method = undefined;\n                starRequestHandler = type;\n            }\n            else if (Is.string(type)) {\n                method = null;\n                if (handler !== undefined) {\n                    method = type;\n                    requestHandlers.set(type, { handler: handler, type: undefined });\n                }\n            }\n            else {\n                if (handler !== undefined) {\n                    method = type.method;\n                    requestHandlers.set(type.method, { type, handler });\n                }\n            }\n            return {\n                dispose: () => {\n                    if (method === null) {\n                        return;\n                    }\n                    if (method !== undefined) {\n                        requestHandlers.delete(method);\n                    }\n                    else {\n                        starRequestHandler = undefined;\n                    }\n                }\n            };\n        },\n        hasPendingResponse: () => {\n            return responsePromises.size > 0;\n        },\n        trace: async (_value, _tracer, sendNotificationOrTraceOptions) => {\n            let _sendNotification = false;\n            let _traceFormat = TraceFormat.Text;\n            if (sendNotificationOrTraceOptions !== undefined) {\n                if (Is.boolean(sendNotificationOrTraceOptions)) {\n                    _sendNotification = sendNotificationOrTraceOptions;\n                }\n                else {\n                    _sendNotification = sendNotificationOrTraceOptions.sendNotification || false;\n                    _traceFormat = sendNotificationOrTraceOptions.traceFormat || TraceFormat.Text;\n                }\n            }\n            trace = _value;\n            traceFormat = _traceFormat;\n            if (trace === Trace.Off) {\n                tracer = undefined;\n            }\n            else {\n                tracer = _tracer;\n            }\n            if (_sendNotification && !isClosed() && !isDisposed()) {\n                await connection.sendNotification(SetTraceNotification.type, { value: Trace.toString(_value) });\n            }\n        },\n        onError: errorEmitter.event,\n        onClose: closeEmitter.event,\n        onUnhandledNotification: unhandledNotificationEmitter.event,\n        onDispose: disposeEmitter.event,\n        end: () => {\n            messageWriter.end();\n        },\n        dispose: () => {\n            if (isDisposed()) {\n                return;\n            }\n            state = ConnectionState.Disposed;\n            disposeEmitter.fire(undefined);\n            const error = new messages_1.ResponseError(messages_1.ErrorCodes.PendingResponseRejected, 'Pending response rejected since connection got disposed');\n            for (const promise of responsePromises.values()) {\n                promise.reject(error);\n            }\n            responsePromises = new Map();\n            requestTokens = new Map();\n            knownCanceledRequests = new Set();\n            messageQueue = new linkedMap_1.LinkedMap();\n            // Test for backwards compatibility\n            if (Is.func(messageWriter.dispose)) {\n                messageWriter.dispose();\n            }\n            if (Is.func(messageReader.dispose)) {\n                messageReader.dispose();\n            }\n        },\n        listen: () => {\n            throwIfClosedOrDisposed();\n            throwIfListening();\n            state = ConnectionState.Listening;\n            messageReader.listen(callback);\n        },\n        inspect: () => {\n            // eslint-disable-next-line no-console\n            (0, ral_1.default)().console.log('inspect');\n        }\n    };\n    connection.onNotification(LogTraceNotification.type, (params) => {\n        if (trace === Trace.Off || !tracer) {\n            return;\n        }\n        const verbose = trace === Trace.Verbose || trace === Trace.Compact;\n        tracer.log(params.message, verbose ? params.verbose : undefined);\n    });\n    connection.onNotification(ProgressNotification.type, (params) => {\n        const handler = progressHandlers.get(params.token);\n        if (handler) {\n            handler(params.value);\n        }\n        else {\n            unhandledProgressEmitter.fire(params);\n        }\n    });\n    return connection;\n}\nexports.createMessageConnection = createMessageConnection;\n","\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Disposable = void 0;\nvar Disposable;\n(function (Disposable) {\n    function create(func) {\n        return {\n            dispose: func\n        };\n    }\n    Disposable.create = create;\n})(Disposable || (exports.Disposable = Disposable = {}));\n","\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Emitter = exports.Event = void 0;\nconst ral_1 = require(\"./ral\");\nvar Event;\n(function (Event) {\n    const _disposable = { dispose() { } };\n    Event.None = function () { return _disposable; };\n})(Event || (exports.Event = Event = {}));\nclass CallbackList {\n    add(callback, context = null, bucket) {\n        if (!this._callbacks) {\n            this._callbacks = [];\n            this._contexts = [];\n        }\n        this._callbacks.push(callback);\n        this._contexts.push(context);\n        if (Array.isArray(bucket)) {\n            bucket.push({ dispose: () => this.remove(callback, context) });\n        }\n    }\n    remove(callback, context = null) {\n        if (!this._callbacks) {\n            return;\n        }\n        let foundCallbackWithDifferentContext = false;\n        for (let i = 0, len = this._callbacks.length; i < len; i++) {\n            if (this._callbacks[i] === callback) {\n                if (this._contexts[i] === context) {\n                    // callback & context match => remove it\n                    this._callbacks.splice(i, 1);\n                    this._contexts.splice(i, 1);\n                    return;\n                }\n                else {\n                    foundCallbackWithDifferentContext = true;\n                }\n            }\n        }\n        if (foundCallbackWithDifferentContext) {\n            throw new Error('When adding a listener with a context, you should remove it with the same context');\n        }\n    }\n    invoke(...args) {\n        if (!this._callbacks) {\n            return [];\n        }\n        const ret = [], callbacks = this._callbacks.slice(0), contexts = this._contexts.slice(0);\n        for (let i = 0, len = callbacks.length; i < len; i++) {\n            try {\n                ret.push(callbacks[i].apply(contexts[i], args));\n            }\n            catch (e) {\n                // eslint-disable-next-line no-console\n                (0, ral_1.default)().console.error(e);\n            }\n        }\n        return ret;\n    }\n    isEmpty() {\n        return !this._callbacks || this._callbacks.length === 0;\n    }\n    dispose() {\n        this._callbacks = undefined;\n        this._contexts = undefined;\n    }\n}\nclass Emitter {\n    constructor(_options) {\n        this._options = _options;\n    }\n    /**\n     * For the public to allow to subscribe\n     * to events from this Emitter\n     */\n    get event() {\n        if (!this._event) {\n            this._event = (listener, thisArgs, disposables) => {\n                if (!this._callbacks) {\n                    this._callbacks = new CallbackList();\n                }\n                if (this._options && this._options.onFirstListenerAdd && this._callbacks.isEmpty()) {\n                    this._options.onFirstListenerAdd(this);\n                }\n                this._callbacks.add(listener, thisArgs);\n                const result = {\n                    dispose: () => {\n                        if (!this._callbacks) {\n                            // disposable is disposed after emitter is disposed.\n                            return;\n                        }\n                        this._callbacks.remove(listener, thisArgs);\n                        result.dispose = Emitter._noop;\n                        if (this._options && this._options.onLastListenerRemove && this._callbacks.isEmpty()) {\n                            this._options.onLastListenerRemove(this);\n                        }\n                    }\n                };\n                if (Array.isArray(disposables)) {\n                    disposables.push(result);\n                }\n                return result;\n            };\n        }\n        return this._event;\n    }\n    /**\n     * To be kept private to fire an event to\n     * subscribers\n     */\n    fire(event) {\n        if (this._callbacks) {\n            this._callbacks.invoke.call(this._callbacks, event);\n        }\n    }\n    dispose() {\n        if (this._callbacks) {\n            this._callbacks.dispose();\n            this._callbacks = undefined;\n        }\n    }\n}\nexports.Emitter = Emitter;\nEmitter._noop = function () { };\n","\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.stringArray = exports.array = exports.func = exports.error = exports.number = exports.string = exports.boolean = void 0;\nfunction boolean(value) {\n    return value === true || value === false;\n}\nexports.boolean = boolean;\nfunction string(value) {\n    return typeof value === 'string' || value instanceof String;\n}\nexports.string = string;\nfunction number(value) {\n    return typeof value === 'number' || value instanceof Number;\n}\nexports.number = number;\nfunction error(value) {\n    return value instanceof Error;\n}\nexports.error = error;\nfunction func(value) {\n    return typeof value === 'function';\n}\nexports.func = func;\nfunction array(value) {\n    return Array.isArray(value);\n}\nexports.array = array;\nfunction stringArray(value) {\n    return array(value) && value.every(elem => string(elem));\n}\nexports.stringArray = stringArray;\n","\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar _a;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.LRUCache = exports.LinkedMap = exports.Touch = void 0;\nvar Touch;\n(function (Touch) {\n    Touch.None = 0;\n    Touch.First = 1;\n    Touch.AsOld = Touch.First;\n    Touch.Last = 2;\n    Touch.AsNew = Touch.Last;\n})(Touch || (exports.Touch = Touch = {}));\nclass LinkedMap {\n    constructor() {\n        this[_a] = 'LinkedMap';\n        this._map = new Map();\n        this._head = undefined;\n        this._tail = undefined;\n        this._size = 0;\n        this._state = 0;\n    }\n    clear() {\n        this._map.clear();\n        this._head = undefined;\n        this._tail = undefined;\n        this._size = 0;\n        this._state++;\n    }\n    isEmpty() {\n        return !this._head && !this._tail;\n    }\n    get size() {\n        return this._size;\n    }\n    get first() {\n        return this._head?.value;\n    }\n    get last() {\n        return this._tail?.value;\n    }\n    has(key) {\n        return this._map.has(key);\n    }\n    get(key, touch = Touch.None) {\n        const item = this._map.get(key);\n        if (!item) {\n            return undefined;\n        }\n        if (touch !== Touch.None) {\n            this.touch(item, touch);\n        }\n        return item.value;\n    }\n    set(key, value, touch = Touch.None) {\n        let item = this._map.get(key);\n        if (item) {\n            item.value = value;\n            if (touch !== Touch.None) {\n                this.touch(item, touch);\n            }\n        }\n        else {\n            item = { key, value, next: undefined, previous: undefined };\n            switch (touch) {\n                case Touch.None:\n                    this.addItemLast(item);\n                    break;\n                case Touch.First:\n                    this.addItemFirst(item);\n                    break;\n                case Touch.Last:\n                    this.addItemLast(item);\n                    break;\n                default:\n                    this.addItemLast(item);\n                    break;\n            }\n            this._map.set(key, item);\n            this._size++;\n        }\n        return this;\n    }\n    delete(key) {\n        return !!this.remove(key);\n    }\n    remove(key) {\n        const item = this._map.get(key);\n        if (!item) {\n            return undefined;\n        }\n        this._map.delete(key);\n        this.removeItem(item);\n        this._size--;\n        return item.value;\n    }\n    shift() {\n        if (!this._head && !this._tail) {\n            return undefined;\n        }\n        if (!this._head || !this._tail) {\n            throw new Error('Invalid list');\n        }\n        const item = this._head;\n        this._map.delete(item.key);\n        this.removeItem(item);\n        this._size--;\n        return item.value;\n    }\n    forEach(callbackfn, thisArg) {\n        const state = this._state;\n        let current = this._head;\n        while (current) {\n            if (thisArg) {\n                callbackfn.bind(thisArg)(current.value, current.key, this);\n            }\n            else {\n                callbackfn(current.value, current.key, this);\n            }\n            if (this._state !== state) {\n                throw new Error(`LinkedMap got modified during iteration.`);\n            }\n            current = current.next;\n        }\n    }\n    keys() {\n        const state = this._state;\n        let current = this._head;\n        const iterator = {\n            [Symbol.iterator]: () => {\n                return iterator;\n            },\n            next: () => {\n                if (this._state !== state) {\n                    throw new Error(`LinkedMap got modified during iteration.`);\n                }\n                if (current) {\n                    const result = { value: current.key, done: false };\n                    current = current.next;\n                    return result;\n                }\n                else {\n                    return { value: undefined, done: true };\n                }\n            }\n        };\n        return iterator;\n    }\n    values() {\n        const state = this._state;\n        let current = this._head;\n        const iterator = {\n            [Symbol.iterator]: () => {\n                return iterator;\n            },\n            next: () => {\n                if (this._state !== state) {\n                    throw new Error(`LinkedMap got modified during iteration.`);\n                }\n                if (current) {\n                    const result = { value: current.value, done: false };\n                    current = current.next;\n                    return result;\n                }\n                else {\n                    return { value: undefined, done: true };\n                }\n            }\n        };\n        return iterator;\n    }\n    entries() {\n        const state = this._state;\n        let current = this._head;\n        const iterator = {\n            [Symbol.iterator]: () => {\n                return iterator;\n            },\n            next: () => {\n                if (this._state !== state) {\n                    throw new Error(`LinkedMap got modified during iteration.`);\n                }\n                if (current) {\n                    const result = { value: [current.key, current.value], done: false };\n                    current = current.next;\n                    return result;\n                }\n                else {\n                    return { value: undefined, done: true };\n                }\n            }\n        };\n        return iterator;\n    }\n    [(_a = Symbol.toStringTag, Symbol.iterator)]() {\n        return this.entries();\n    }\n    trimOld(newSize) {\n        if (newSize >= this.size) {\n            return;\n        }\n        if (newSize === 0) {\n            this.clear();\n            return;\n        }\n        let current = this._head;\n        let currentSize = this.size;\n        while (current && currentSize > newSize) {\n            this._map.delete(current.key);\n            current = current.next;\n            currentSize--;\n        }\n        this._head = current;\n        this._size = currentSize;\n        if (current) {\n            current.previous = undefined;\n        }\n        this._state++;\n    }\n    addItemFirst(item) {\n        // First time Insert\n        if (!this._head && !this._tail) {\n            this._tail = item;\n        }\n        else if (!this._head) {\n            throw new Error('Invalid list');\n        }\n        else {\n            item.next = this._head;\n            this._head.previous = item;\n        }\n        this._head = item;\n        this._state++;\n    }\n    addItemLast(item) {\n        // First time Insert\n        if (!this._head && !this._tail) {\n            this._head = item;\n        }\n        else if (!this._tail) {\n            throw new Error('Invalid list');\n        }\n        else {\n            item.previous = this._tail;\n            this._tail.next = item;\n        }\n        this._tail = item;\n        this._state++;\n    }\n    removeItem(item) {\n        if (item === this._head && item === this._tail) {\n            this._head = undefined;\n            this._tail = undefined;\n        }\n        else if (item === this._head) {\n            // This can only happened if size === 1 which is handle\n            // by the case above.\n            if (!item.next) {\n                throw new Error('Invalid list');\n            }\n            item.next.previous = undefined;\n            this._head = item.next;\n        }\n        else if (item === this._tail) {\n            // This can only happened if size === 1 which is handle\n            // by the case above.\n            if (!item.previous) {\n                throw new Error('Invalid list');\n            }\n            item.previous.next = undefined;\n            this._tail = item.previous;\n        }\n        else {\n            const next = item.next;\n            const previous = item.previous;\n            if (!next || !previous) {\n                throw new Error('Invalid list');\n            }\n            next.previous = previous;\n            previous.next = next;\n        }\n        item.next = undefined;\n        item.previous = undefined;\n        this._state++;\n    }\n    touch(item, touch) {\n        if (!this._head || !this._tail) {\n            throw new Error('Invalid list');\n        }\n        if ((touch !== Touch.First && touch !== Touch.Last)) {\n            return;\n        }\n        if (touch === Touch.First) {\n            if (item === this._head) {\n                return;\n            }\n            const next = item.next;\n            const previous = item.previous;\n            // Unlink the item\n            if (item === this._tail) {\n                // previous must be defined since item was not head but is tail\n                // So there are more than on item in the map\n                previous.next = undefined;\n                this._tail = previous;\n            }\n            else {\n                // Both next and previous are not undefined since item was neither head nor tail.\n                next.previous = previous;\n                previous.next = next;\n            }\n            // Insert the node at head\n            item.previous = undefined;\n            item.next = this._head;\n            this._head.previous = item;\n            this._head = item;\n            this._state++;\n        }\n        else if (touch === Touch.Last) {\n            if (item === this._tail) {\n                return;\n            }\n            const next = item.next;\n            const previous = item.previous;\n            // Unlink the item.\n            if (item === this._head) {\n                // next must be defined since item was not tail but is head\n                // So there are more than on item in the map\n                next.previous = undefined;\n                this._head = next;\n            }\n            else {\n                // Both next and previous are not undefined since item was neither head nor tail.\n                next.previous = previous;\n                previous.next = next;\n            }\n            item.next = undefined;\n            item.previous = this._tail;\n            this._tail.next = item;\n            this._tail = item;\n            this._state++;\n        }\n    }\n    toJSON() {\n        const data = [];\n        this.forEach((value, key) => {\n            data.push([key, value]);\n        });\n        return data;\n    }\n    fromJSON(data) {\n        this.clear();\n        for (const [key, value] of data) {\n            this.set(key, value);\n        }\n    }\n}\nexports.LinkedMap = LinkedMap;\nclass LRUCache extends LinkedMap {\n    constructor(limit, ratio = 1) {\n        super();\n        this._limit = limit;\n        this._ratio = Math.min(Math.max(0, ratio), 1);\n    }\n    get limit() {\n        return this._limit;\n    }\n    set limit(limit) {\n        this._limit = limit;\n        this.checkTrim();\n    }\n    get ratio() {\n        return this._ratio;\n    }\n    set ratio(ratio) {\n        this._ratio = Math.min(Math.max(0, ratio), 1);\n        this.checkTrim();\n    }\n    get(key, touch = Touch.AsNew) {\n        return super.get(key, touch);\n    }\n    peek(key) {\n        return super.get(key, Touch.None);\n    }\n    set(key, value) {\n        super.set(key, value, Touch.Last);\n        this.checkTrim();\n        return this;\n    }\n    checkTrim() {\n        if (this.size > this._limit) {\n            this.trimOld(Math.round(this._limit * this._ratio));\n        }\n    }\n}\nexports.LRUCache = LRUCache;\n","\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.AbstractMessageBuffer = void 0;\nconst CR = 13;\nconst LF = 10;\nconst CRLF = '\\r\\n';\nclass AbstractMessageBuffer {\n    constructor(encoding = 'utf-8') {\n        this._encoding = encoding;\n        this._chunks = [];\n        this._totalLength = 0;\n    }\n    get encoding() {\n        return this._encoding;\n    }\n    append(chunk) {\n        const toAppend = typeof chunk === 'string' ? this.fromString(chunk, this._encoding) : chunk;\n        this._chunks.push(toAppend);\n        this._totalLength += toAppend.byteLength;\n    }\n    tryReadHeaders(lowerCaseKeys = false) {\n        if (this._chunks.length === 0) {\n            return undefined;\n        }\n        let state = 0;\n        let chunkIndex = 0;\n        let offset = 0;\n        let chunkBytesRead = 0;\n        row: while (chunkIndex < this._chunks.length) {\n            const chunk = this._chunks[chunkIndex];\n            offset = 0;\n            column: while (offset < chunk.length) {\n                const value = chunk[offset];\n                switch (value) {\n                    case CR:\n                        switch (state) {\n                            case 0:\n                                state = 1;\n                                break;\n                            case 2:\n                                state = 3;\n                                break;\n                            default:\n                                state = 0;\n                        }\n                        break;\n                    case LF:\n                        switch (state) {\n                            case 1:\n                                state = 2;\n                                break;\n                            case 3:\n                                state = 4;\n                                offset++;\n                                break row;\n                            default:\n                                state = 0;\n                        }\n                        break;\n                    default:\n                        state = 0;\n                }\n                offset++;\n            }\n            chunkBytesRead += chunk.byteLength;\n            chunkIndex++;\n        }\n        if (state !== 4) {\n            return undefined;\n        }\n        // The buffer contains the two CRLF at the end. So we will\n        // have two empty lines after the split at the end as well.\n        const buffer = this._read(chunkBytesRead + offset);\n        const result = new Map();\n        const headers = this.toString(buffer, 'ascii').split(CRLF);\n        if (headers.length < 2) {\n            return result;\n        }\n        for (let i = 0; i < headers.length - 2; i++) {\n            const header = headers[i];\n            const index = header.indexOf(':');\n            if (index === -1) {\n                throw new Error(`Message header must separate key and value using ':'\\n${header}`);\n            }\n            const key = header.substr(0, index);\n            const value = header.substr(index + 1).trim();\n            result.set(lowerCaseKeys ? key.toLowerCase() : key, value);\n        }\n        return result;\n    }\n    tryReadBody(length) {\n        if (this._totalLength < length) {\n            return undefined;\n        }\n        return this._read(length);\n    }\n    get numberOfBytes() {\n        return this._totalLength;\n    }\n    _read(byteCount) {\n        if (byteCount === 0) {\n            return this.emptyBuffer();\n        }\n        if (byteCount > this._totalLength) {\n            throw new Error(`Cannot read so many bytes!`);\n        }\n        if (this._chunks[0].byteLength === byteCount) {\n            // super fast path, precisely first chunk must be returned\n            const chunk = this._chunks[0];\n            this._chunks.shift();\n            this._totalLength -= byteCount;\n            return this.asNative(chunk);\n        }\n        if (this._chunks[0].byteLength > byteCount) {\n            // fast path, the reading is entirely within the first chunk\n            const chunk = this._chunks[0];\n            const result = this.asNative(chunk, byteCount);\n            this._chunks[0] = chunk.slice(byteCount);\n            this._totalLength -= byteCount;\n            return result;\n        }\n        const result = this.allocNative(byteCount);\n        let resultOffset = 0;\n        let chunkIndex = 0;\n        while (byteCount > 0) {\n            const chunk = this._chunks[chunkIndex];\n            if (chunk.byteLength > byteCount) {\n                // this chunk will survive\n                const chunkPart = chunk.slice(0, byteCount);\n                result.set(chunkPart, resultOffset);\n                resultOffset += byteCount;\n                this._chunks[chunkIndex] = chunk.slice(byteCount);\n                this._totalLength -= byteCount;\n                byteCount -= byteCount;\n            }\n            else {\n                // this chunk will be entirely read\n                result.set(chunk, resultOffset);\n                resultOffset += chunk.byteLength;\n                this._chunks.shift();\n                this._totalLength -= chunk.byteLength;\n                byteCount -= chunk.byteLength;\n            }\n        }\n        return result;\n    }\n}\nexports.AbstractMessageBuffer = AbstractMessageBuffer;\n","\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ReadableStreamMessageReader = exports.AbstractMessageReader = exports.MessageReader = void 0;\nconst ral_1 = require(\"./ral\");\nconst Is = require(\"./is\");\nconst events_1 = require(\"./events\");\nconst semaphore_1 = require(\"./semaphore\");\nvar MessageReader;\n(function (MessageReader) {\n    function is(value) {\n        let candidate = value;\n        return candidate && Is.func(candidate.listen) && Is.func(candidate.dispose) &&\n            Is.func(candidate.onError) && Is.func(candidate.onClose) && Is.func(candidate.onPartialMessage);\n    }\n    MessageReader.is = is;\n})(MessageReader || (exports.MessageReader = MessageReader = {}));\nclass AbstractMessageReader {\n    constructor() {\n        this.errorEmitter = new events_1.Emitter();\n        this.closeEmitter = new events_1.Emitter();\n        this.partialMessageEmitter = new events_1.Emitter();\n    }\n    dispose() {\n        this.errorEmitter.dispose();\n        this.closeEmitter.dispose();\n    }\n    get onError() {\n        return this.errorEmitter.event;\n    }\n    fireError(error) {\n        this.errorEmitter.fire(this.asError(error));\n    }\n    get onClose() {\n        return this.closeEmitter.event;\n    }\n    fireClose() {\n        this.closeEmitter.fire(undefined);\n    }\n    get onPartialMessage() {\n        return this.partialMessageEmitter.event;\n    }\n    firePartialMessage(info) {\n        this.partialMessageEmitter.fire(info);\n    }\n    asError(error) {\n        if (error instanceof Error) {\n            return error;\n        }\n        else {\n            return new Error(`Reader received error. Reason: ${Is.string(error.message) ? error.message : 'unknown'}`);\n        }\n    }\n}\nexports.AbstractMessageReader = AbstractMessageReader;\nvar ResolvedMessageReaderOptions;\n(function (ResolvedMessageReaderOptions) {\n    function fromOptions(options) {\n        let charset;\n        let result;\n        let contentDecoder;\n        const contentDecoders = new Map();\n        let contentTypeDecoder;\n        const contentTypeDecoders = new Map();\n        if (options === undefined || typeof options === 'string') {\n            charset = options ?? 'utf-8';\n        }\n        else {\n            charset = options.charset ?? 'utf-8';\n            if (options.contentDecoder !== undefined) {\n                contentDecoder = options.contentDecoder;\n                contentDecoders.set(contentDecoder.name, contentDecoder);\n            }\n            if (options.contentDecoders !== undefined) {\n                for (const decoder of options.contentDecoders) {\n                    contentDecoders.set(decoder.name, decoder);\n                }\n            }\n            if (options.contentTypeDecoder !== undefined) {\n                contentTypeDecoder = options.contentTypeDecoder;\n                contentTypeDecoders.set(contentTypeDecoder.name, contentTypeDecoder);\n            }\n            if (options.contentTypeDecoders !== undefined) {\n                for (const decoder of options.contentTypeDecoders) {\n                    contentTypeDecoders.set(decoder.name, decoder);\n                }\n            }\n        }\n        if (contentTypeDecoder === undefined) {\n            contentTypeDecoder = (0, ral_1.default)().applicationJson.decoder;\n            contentTypeDecoders.set(contentTypeDecoder.name, contentTypeDecoder);\n        }\n        return { charset, contentDecoder, contentDecoders, contentTypeDecoder, contentTypeDecoders };\n    }\n    ResolvedMessageReaderOptions.fromOptions = fromOptions;\n})(ResolvedMessageReaderOptions || (ResolvedMessageReaderOptions = {}));\nclass ReadableStreamMessageReader extends AbstractMessageReader {\n    constructor(readable, options) {\n        super();\n        this.readable = readable;\n        this.options = ResolvedMessageReaderOptions.fromOptions(options);\n        this.buffer = (0, ral_1.default)().messageBuffer.create(this.options.charset);\n        this._partialMessageTimeout = 10000;\n        this.nextMessageLength = -1;\n        this.messageToken = 0;\n        this.readSemaphore = new semaphore_1.Semaphore(1);\n    }\n    set partialMessageTimeout(timeout) {\n        this._partialMessageTimeout = timeout;\n    }\n    get partialMessageTimeout() {\n        return this._partialMessageTimeout;\n    }\n    listen(callback) {\n        this.nextMessageLength = -1;\n        this.messageToken = 0;\n        this.partialMessageTimer = undefined;\n        this.callback = callback;\n        const result = this.readable.onData((data) => {\n            this.onData(data);\n        });\n        this.readable.onError((error) => this.fireError(error));\n        this.readable.onClose(() => this.fireClose());\n        return result;\n    }\n    onData(data) {\n        try {\n            this.buffer.append(data);\n            while (true) {\n                if (this.nextMessageLength === -1) {\n                    const headers = this.buffer.tryReadHeaders(true);\n                    if (!headers) {\n                        return;\n                    }\n                    const contentLength = headers.get('content-length');\n                    if (!contentLength) {\n                        this.fireError(new Error(`Header must provide a Content-Length property.\\n${JSON.stringify(Object.fromEntries(headers))}`));\n                        return;\n                    }\n                    const length = parseInt(contentLength);\n                    if (isNaN(length)) {\n                        this.fireError(new Error(`Content-Length value must be a number. Got ${contentLength}`));\n                        return;\n                    }\n                    this.nextMessageLength = length;\n                }\n                const body = this.buffer.tryReadBody(this.nextMessageLength);\n                if (body === undefined) {\n                    /** We haven't received the full message yet. */\n                    this.setPartialMessageTimer();\n                    return;\n                }\n                this.clearPartialMessageTimer();\n                this.nextMessageLength = -1;\n                // Make sure that we convert one received message after the\n                // other. Otherwise it could happen that a decoding of a second\n                // smaller message finished before the decoding of a first larger\n                // message and then we would deliver the second message first.\n                this.readSemaphore.lock(async () => {\n                    const bytes = this.options.contentDecoder !== undefined\n                        ? await this.options.contentDecoder.decode(body)\n                        : body;\n                    const message = await this.options.contentTypeDecoder.decode(bytes, this.options);\n                    this.callback(message);\n                }).catch((error) => {\n                    this.fireError(error);\n                });\n            }\n        }\n        catch (error) {\n            this.fireError(error);\n        }\n    }\n    clearPartialMessageTimer() {\n        if (this.partialMessageTimer) {\n            this.partialMessageTimer.dispose();\n            this.partialMessageTimer = undefined;\n        }\n    }\n    setPartialMessageTimer() {\n        this.clearPartialMessageTimer();\n        if (this._partialMessageTimeout <= 0) {\n            return;\n        }\n        this.partialMessageTimer = (0, ral_1.default)().timer.setTimeout((token, timeout) => {\n            this.partialMessageTimer = undefined;\n            if (token === this.messageToken) {\n                this.firePartialMessage({ messageToken: token, waitingTime: timeout });\n                this.setPartialMessageTimer();\n            }\n        }, this._partialMessageTimeout, this.messageToken, this._partialMessageTimeout);\n    }\n}\nexports.ReadableStreamMessageReader = ReadableStreamMessageReader;\n","\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WriteableStreamMessageWriter = exports.AbstractMessageWriter = exports.MessageWriter = void 0;\nconst ral_1 = require(\"./ral\");\nconst Is = require(\"./is\");\nconst semaphore_1 = require(\"./semaphore\");\nconst events_1 = require(\"./events\");\nconst ContentLength = 'Content-Length: ';\nconst CRLF = '\\r\\n';\nvar MessageWriter;\n(function (MessageWriter) {\n    function is(value) {\n        let candidate = value;\n        return candidate && Is.func(candidate.dispose) && Is.func(candidate.onClose) &&\n            Is.func(candidate.onError) && Is.func(candidate.write);\n    }\n    MessageWriter.is = is;\n})(MessageWriter || (exports.MessageWriter = MessageWriter = {}));\nclass AbstractMessageWriter {\n    constructor() {\n        this.errorEmitter = new events_1.Emitter();\n        this.closeEmitter = new events_1.Emitter();\n    }\n    dispose() {\n        this.errorEmitter.dispose();\n        this.closeEmitter.dispose();\n    }\n    get onError() {\n        return this.errorEmitter.event;\n    }\n    fireError(error, message, count) {\n        this.errorEmitter.fire([this.asError(error), message, count]);\n    }\n    get onClose() {\n        return this.closeEmitter.event;\n    }\n    fireClose() {\n        this.closeEmitter.fire(undefined);\n    }\n    asError(error) {\n        if (error instanceof Error) {\n            return error;\n        }\n        else {\n            return new Error(`Writer received error. Reason: ${Is.string(error.message) ? error.message : 'unknown'}`);\n        }\n    }\n}\nexports.AbstractMessageWriter = AbstractMessageWriter;\nvar ResolvedMessageWriterOptions;\n(function (ResolvedMessageWriterOptions) {\n    function fromOptions(options) {\n        if (options === undefined || typeof options === 'string') {\n            return { charset: options ?? 'utf-8', contentTypeEncoder: (0, ral_1.default)().applicationJson.encoder };\n        }\n        else {\n            return { charset: options.charset ?? 'utf-8', contentEncoder: options.contentEncoder, contentTypeEncoder: options.contentTypeEncoder ?? (0, ral_1.default)().applicationJson.encoder };\n        }\n    }\n    ResolvedMessageWriterOptions.fromOptions = fromOptions;\n})(ResolvedMessageWriterOptions || (ResolvedMessageWriterOptions = {}));\nclass WriteableStreamMessageWriter extends AbstractMessageWriter {\n    constructor(writable, options) {\n        super();\n        this.writable = writable;\n        this.options = ResolvedMessageWriterOptions.fromOptions(options);\n        this.errorCount = 0;\n        this.writeSemaphore = new semaphore_1.Semaphore(1);\n        this.writable.onError((error) => this.fireError(error));\n        this.writable.onClose(() => this.fireClose());\n    }\n    async write(msg) {\n        return this.writeSemaphore.lock(async () => {\n            const payload = this.options.contentTypeEncoder.encode(msg, this.options).then((buffer) => {\n                if (this.options.contentEncoder !== undefined) {\n                    return this.options.contentEncoder.encode(buffer);\n                }\n                else {\n                    return buffer;\n                }\n            });\n            return payload.then((buffer) => {\n                const headers = [];\n                headers.push(ContentLength, buffer.byteLength.toString(), CRLF);\n                headers.push(CRLF);\n                return this.doWrite(msg, headers, buffer);\n            }, (error) => {\n                this.fireError(error);\n                throw error;\n            });\n        });\n    }\n    async doWrite(msg, headers, data) {\n        try {\n            await this.writable.write(headers.join(''), 'ascii');\n            return this.writable.write(data);\n        }\n        catch (error) {\n            this.handleError(error, msg);\n            return Promise.reject(error);\n        }\n    }\n    handleError(error, msg) {\n        this.errorCount++;\n        this.fireError(error, msg, this.errorCount);\n    }\n    end() {\n        this.writable.end();\n    }\n}\nexports.WriteableStreamMessageWriter = WriteableStreamMessageWriter;\n","\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Message = exports.NotificationType9 = exports.NotificationType8 = exports.NotificationType7 = exports.NotificationType6 = exports.NotificationType5 = exports.NotificationType4 = exports.NotificationType3 = exports.NotificationType2 = exports.NotificationType1 = exports.NotificationType0 = exports.NotificationType = exports.RequestType9 = exports.RequestType8 = exports.RequestType7 = exports.RequestType6 = exports.RequestType5 = exports.RequestType4 = exports.RequestType3 = exports.RequestType2 = exports.RequestType1 = exports.RequestType = exports.RequestType0 = exports.AbstractMessageSignature = exports.ParameterStructures = exports.ResponseError = exports.ErrorCodes = void 0;\nconst is = require(\"./is\");\n/**\n * Predefined error codes.\n */\nvar ErrorCodes;\n(function (ErrorCodes) {\n    // Defined by JSON RPC\n    ErrorCodes.ParseError = -32700;\n    ErrorCodes.InvalidRequest = -32600;\n    ErrorCodes.MethodNotFound = -32601;\n    ErrorCodes.InvalidParams = -32602;\n    ErrorCodes.InternalError = -32603;\n    /**\n     * This is the start range of JSON RPC reserved error codes.\n     * It doesn't denote a real error code. No application error codes should\n     * be defined between the start and end range. For backwards\n     * compatibility the `ServerNotInitialized` and the `UnknownErrorCode`\n     * are left in the range.\n     *\n     * @since 3.16.0\n    */\n    ErrorCodes.jsonrpcReservedErrorRangeStart = -32099;\n    /** @deprecated use  jsonrpcReservedErrorRangeStart */\n    ErrorCodes.serverErrorStart = -32099;\n    /**\n     * An error occurred when write a message to the transport layer.\n     */\n    ErrorCodes.MessageWriteError = -32099;\n    /**\n     * An error occurred when reading a message from the transport layer.\n     */\n    ErrorCodes.MessageReadError = -32098;\n    /**\n     * The connection got disposed or lost and all pending responses got\n     * rejected.\n     */\n    ErrorCodes.PendingResponseRejected = -32097;\n    /**\n     * The connection is inactive and a use of it failed.\n     */\n    ErrorCodes.ConnectionInactive = -32096;\n    /**\n     * Error code indicating that a server received a notification or\n     * request before the server has received the `initialize` request.\n     */\n    ErrorCodes.ServerNotInitialized = -32002;\n    ErrorCodes.UnknownErrorCode = -32001;\n    /**\n     * This is the end range of JSON RPC reserved error codes.\n     * It doesn't denote a real error code.\n     *\n     * @since 3.16.0\n    */\n    ErrorCodes.jsonrpcReservedErrorRangeEnd = -32000;\n    /** @deprecated use  jsonrpcReservedErrorRangeEnd */\n    ErrorCodes.serverErrorEnd = -32000;\n})(ErrorCodes || (exports.ErrorCodes = ErrorCodes = {}));\n/**\n * An error object return in a response in case a request\n * has failed.\n */\nclass ResponseError extends Error {\n    constructor(code, message, data) {\n        super(message);\n        this.code = is.number(code) ? code : ErrorCodes.UnknownErrorCode;\n        this.data = data;\n        Object.setPrototypeOf(this, ResponseError.prototype);\n    }\n    toJson() {\n        const result = {\n            code: this.code,\n            message: this.message\n        };\n        if (this.data !== undefined) {\n            result.data = this.data;\n        }\n        return result;\n    }\n}\nexports.ResponseError = ResponseError;\nclass ParameterStructures {\n    constructor(kind) {\n        this.kind = kind;\n    }\n    static is(value) {\n        return value === ParameterStructures.auto || value === ParameterStructures.byName || value === ParameterStructures.byPosition;\n    }\n    toString() {\n        return this.kind;\n    }\n}\nexports.ParameterStructures = ParameterStructures;\n/**\n * The parameter structure is automatically inferred on the number of parameters\n * and the parameter type in case of a single param.\n */\nParameterStructures.auto = new ParameterStructures('auto');\n/**\n * Forces `byPosition` parameter structure. This is useful if you have a single\n * parameter which has a literal type.\n */\nParameterStructures.byPosition = new ParameterStructures('byPosition');\n/**\n * Forces `byName` parameter structure. This is only useful when having a single\n * parameter. The library will report errors if used with a different number of\n * parameters.\n */\nParameterStructures.byName = new ParameterStructures('byName');\n/**\n * An abstract implementation of a MessageType.\n */\nclass AbstractMessageSignature {\n    constructor(method, numberOfParams) {\n        this.method = method;\n        this.numberOfParams = numberOfParams;\n    }\n    get parameterStructures() {\n        return ParameterStructures.auto;\n    }\n}\nexports.AbstractMessageSignature = AbstractMessageSignature;\n/**\n * Classes to type request response pairs\n */\nclass RequestType0 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 0);\n    }\n}\nexports.RequestType0 = RequestType0;\nclass RequestType extends AbstractMessageSignature {\n    constructor(method, _parameterStructures = ParameterStructures.auto) {\n        super(method, 1);\n        this._parameterStructures = _parameterStructures;\n    }\n    get parameterStructures() {\n        return this._parameterStructures;\n    }\n}\nexports.RequestType = RequestType;\nclass RequestType1 extends AbstractMessageSignature {\n    constructor(method, _parameterStructures = ParameterStructures.auto) {\n        super(method, 1);\n        this._parameterStructures = _parameterStructures;\n    }\n    get parameterStructures() {\n        return this._parameterStructures;\n    }\n}\nexports.RequestType1 = RequestType1;\nclass RequestType2 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 2);\n    }\n}\nexports.RequestType2 = RequestType2;\nclass RequestType3 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 3);\n    }\n}\nexports.RequestType3 = RequestType3;\nclass RequestType4 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 4);\n    }\n}\nexports.RequestType4 = RequestType4;\nclass RequestType5 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 5);\n    }\n}\nexports.RequestType5 = RequestType5;\nclass RequestType6 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 6);\n    }\n}\nexports.RequestType6 = RequestType6;\nclass RequestType7 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 7);\n    }\n}\nexports.RequestType7 = RequestType7;\nclass RequestType8 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 8);\n    }\n}\nexports.RequestType8 = RequestType8;\nclass RequestType9 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 9);\n    }\n}\nexports.RequestType9 = RequestType9;\nclass NotificationType extends AbstractMessageSignature {\n    constructor(method, _parameterStructures = ParameterStructures.auto) {\n        super(method, 1);\n        this._parameterStructures = _parameterStructures;\n    }\n    get parameterStructures() {\n        return this._parameterStructures;\n    }\n}\nexports.NotificationType = NotificationType;\nclass NotificationType0 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 0);\n    }\n}\nexports.NotificationType0 = NotificationType0;\nclass NotificationType1 extends AbstractMessageSignature {\n    constructor(method, _parameterStructures = ParameterStructures.auto) {\n        super(method, 1);\n        this._parameterStructures = _parameterStructures;\n    }\n    get parameterStructures() {\n        return this._parameterStructures;\n    }\n}\nexports.NotificationType1 = NotificationType1;\nclass NotificationType2 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 2);\n    }\n}\nexports.NotificationType2 = NotificationType2;\nclass NotificationType3 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 3);\n    }\n}\nexports.NotificationType3 = NotificationType3;\nclass NotificationType4 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 4);\n    }\n}\nexports.NotificationType4 = NotificationType4;\nclass NotificationType5 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 5);\n    }\n}\nexports.NotificationType5 = NotificationType5;\nclass NotificationType6 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 6);\n    }\n}\nexports.NotificationType6 = NotificationType6;\nclass NotificationType7 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 7);\n    }\n}\nexports.NotificationType7 = NotificationType7;\nclass NotificationType8 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 8);\n    }\n}\nexports.NotificationType8 = NotificationType8;\nclass NotificationType9 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 9);\n    }\n}\nexports.NotificationType9 = NotificationType9;\nvar Message;\n(function (Message) {\n    /**\n     * Tests if the given message is a request message\n     */\n    function isRequest(message) {\n        const candidate = message;\n        return candidate && is.string(candidate.method) && (is.string(candidate.id) || is.number(candidate.id));\n    }\n    Message.isRequest = isRequest;\n    /**\n     * Tests if the given message is a notification message\n     */\n    function isNotification(message) {\n        const candidate = message;\n        return candidate && is.string(candidate.method) && message.id === void 0;\n    }\n    Message.isNotification = isNotification;\n    /**\n     * Tests if the given message is a response message\n     */\n    function isResponse(message) {\n        const candidate = message;\n        return candidate && (candidate.result !== void 0 || !!candidate.error) && (is.string(candidate.id) || is.number(candidate.id) || candidate.id === null);\n    }\n    Message.isResponse = isResponse;\n})(Message || (exports.Message = Message = {}));\n","\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nlet _ral;\nfunction RAL() {\n    if (_ral === undefined) {\n        throw new Error(`No runtime abstraction layer installed`);\n    }\n    return _ral;\n}\n(function (RAL) {\n    function install(ral) {\n        if (ral === undefined) {\n            throw new Error(`No runtime abstraction layer provided`);\n        }\n        _ral = ral;\n    }\n    RAL.install = install;\n})(RAL || (RAL = {}));\nexports.default = RAL;\n","\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Semaphore = void 0;\nconst ral_1 = require(\"./ral\");\nclass Semaphore {\n    constructor(capacity = 1) {\n        if (capacity <= 0) {\n            throw new Error('Capacity must be greater than 0');\n        }\n        this._capacity = capacity;\n        this._active = 0;\n        this._waiting = [];\n    }\n    lock(thunk) {\n        return new Promise((resolve, reject) => {\n            this._waiting.push({ thunk, resolve, reject });\n            this.runNext();\n        });\n    }\n    get active() {\n        return this._active;\n    }\n    runNext() {\n        if (this._waiting.length === 0 || this._active === this._capacity) {\n            return;\n        }\n        (0, ral_1.default)().timer.setImmediate(() => this.doRunNext());\n    }\n    doRunNext() {\n        if (this._waiting.length === 0 || this._active === this._capacity) {\n            return;\n        }\n        const next = this._waiting.shift();\n        this._active++;\n        if (this._active > this._capacity) {\n            throw new Error(`To many thunks active`);\n        }\n        try {\n            const result = next.thunk();\n            if (result instanceof Promise) {\n                result.then((value) => {\n                    this._active--;\n                    next.resolve(value);\n                    this.runNext();\n                }, (err) => {\n                    this._active--;\n                    next.reject(err);\n                    this.runNext();\n                });\n            }\n            else {\n                this._active--;\n                next.resolve(result);\n                this.runNext();\n            }\n        }\n        catch (err) {\n            this._active--;\n            next.reject(err);\n            this.runNext();\n        }\n    }\n}\nexports.Semaphore = Semaphore;\n","\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.SharedArrayReceiverStrategy = exports.SharedArraySenderStrategy = void 0;\nconst cancellation_1 = require(\"./cancellation\");\nvar CancellationState;\n(function (CancellationState) {\n    CancellationState.Continue = 0;\n    CancellationState.Cancelled = 1;\n})(CancellationState || (CancellationState = {}));\nclass SharedArraySenderStrategy {\n    constructor() {\n        this.buffers = new Map();\n    }\n    enableCancellation(request) {\n        if (request.id === null) {\n            return;\n        }\n        const buffer = new SharedArrayBuffer(4);\n        const data = new Int32Array(buffer, 0, 1);\n        data[0] = CancellationState.Continue;\n        this.buffers.set(request.id, buffer);\n        request.$cancellationData = buffer;\n    }\n    async sendCancellation(_conn, id) {\n        const buffer = this.buffers.get(id);\n        if (buffer === undefined) {\n            return;\n        }\n        const data = new Int32Array(buffer, 0, 1);\n        Atomics.store(data, 0, CancellationState.Cancelled);\n    }\n    cleanup(id) {\n        this.buffers.delete(id);\n    }\n    dispose() {\n        this.buffers.clear();\n    }\n}\nexports.SharedArraySenderStrategy = SharedArraySenderStrategy;\nclass SharedArrayBufferCancellationToken {\n    constructor(buffer) {\n        this.data = new Int32Array(buffer, 0, 1);\n    }\n    get isCancellationRequested() {\n        return Atomics.load(this.data, 0) === CancellationState.Cancelled;\n    }\n    get onCancellationRequested() {\n        throw new Error(`Cancellation over SharedArrayBuffer doesn't support cancellation events`);\n    }\n}\nclass SharedArrayBufferCancellationTokenSource {\n    constructor(buffer) {\n        this.token = new SharedArrayBufferCancellationToken(buffer);\n    }\n    cancel() {\n    }\n    dispose() {\n    }\n}\nclass SharedArrayReceiverStrategy {\n    constructor() {\n        this.kind = 'request';\n    }\n    createCancellationTokenSource(request) {\n        const buffer = request.$cancellationData;\n        if (buffer === undefined) {\n            return new cancellation_1.CancellationTokenSource();\n        }\n        return new SharedArrayBufferCancellationTokenSource(buffer);\n    }\n}\nexports.SharedArrayReceiverStrategy = SharedArrayReceiverStrategy;\n"],"names":["__createBinding","this","Object","create","o","m","k","k2","undefined","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","get","defineProperty","__exportStar","exports","p","prototype","hasOwnProperty","call","value","createMessageConnection","BrowserMessageWriter","BrowserMessageReader","default","install","api_1","AbstractMessageReader","constructor","port","super","_onData","Emitter","_messageListener","event","fire","data","addEventListener","fireError","onmessage","listen","callback","AbstractMessageWriter","errorCount","write","msg","postMessage","Promise","resolve","error","handleError","reject","end","reader","writer","logger","options","NullLogger","ConnectionStrategy","is","connectionStrategy","MessageBuffer","AbstractMessageBuffer","encoding","asciiDecoder","TextDecoder","emptyBuffer","fromString","_encoding","TextEncoder","encode","toString","decode","asNative","buffer","length","slice","allocNative","Uint8Array","ReadableStreamWrapper","socket","arrayBuffer","then","RAL","console","onClose","listener","Disposable","removeEventListener","onError","onEnd","onData","WritableStreamWrapper","Error","send","close","_textEncoder","_ril","freeze","messageBuffer","applicationJson","encoder","name","charset","JSON","stringify","decoder","parse","stream","asReadableStream","asWritableStream","timer","setTimeout","ms","args","handle","dispose","clearTimeout","setImmediate","setInterval","clearInterval","RIL","ProgressType","ProgressToken","ConnectionOptions","WriteableStreamMessageWriter","MessageWriter","ReadableStreamMessageReader","MessageReader","SharedArrayReceiverStrategy","SharedArraySenderStrategy","CancellationToken","CancellationTokenSource","Event","LRUCache","Touch","LinkedMap","ParameterStructures","NotificationType9","NotificationType8","NotificationType7","NotificationType6","NotificationType5","NotificationType4","NotificationType3","NotificationType2","NotificationType1","NotificationType0","NotificationType","ErrorCodes","ResponseError","RequestType9","RequestType8","RequestType7","RequestType6","RequestType5","RequestType4","RequestType3","RequestType2","RequestType1","RequestType0","RequestType","Message","MessageStrategy","CancellationStrategy","CancellationSenderStrategy","CancellationReceiverStrategy","ConnectionError","ConnectionErrors","LogTraceNotification","SetTraceNotification","TraceFormat","TraceValues","Trace","messages_1","linkedMap_1","disposable_1","events_1","cancellation_1","sharedArrayCancellation_1","messageReader_1","messageWriter_1","messageBuffer_1","connection_1","ral_1","Is","None","isCancellationRequested","onCancellationRequested","Cancelled","candidate","boolean","shortcutEvent","context","bind","MutableToken","_isCancelled","cancel","_emitter","token","_token","RequestCancellationReceiverStrategy","IdCancellationReceiverStrategy","CancelNotification","ProgressNotification","StarRequestHandler","ConnectionState","type","func","warn","info","log","Off","Messages","Compact","Verbose","string","toLowerCase","Text","code","message","setPrototypeOf","cancelUndispatched","kind","createCancellationTokenSource","_","sendCancellation","conn","id","sendNotification","cleanup","receiver","sender","handleMessage","cancellationStrategy","messageStrategy","messageReader","messageWriter","_logger","sequenceNumber","notificationSequenceNumber","unknownResponseSequenceNumber","version","starRequestHandler","requestHandlers","Map","starNotificationHandler","notificationHandlers","progressHandlers","tracer","messageQueue","responsePromises","knownCanceledRequests","Set","requestTokens","trace","traceFormat","state","New","errorEmitter","closeEmitter","unhandledNotificationEmitter","unhandledProgressEmitter","disposeEmitter","createRequestQueueKey","_message","isListening","Listening","isClosed","Closed","isDisposed","Disposed","closeHandler","triggerMessageQueue","size","shift","processMessageQueue","isRequest","requestMessage","reply","resultOrError","method","startTime","jsonrpc","toJson","result","traceSendingResponse","catch","replyError","params","stringifyTrace","logLSPMessage","traceReceivedRequest","element","requestHandler","handler","Date","now","tokenKey","String","cancellationSource","has","set","handlerResult","numberOfParams","InvalidParams","Array","isArray","parameterStructures","byName","byPosition","promise","delete","InternalError","replySuccess","MethodNotFound","handleRequest","isNotification","notificationHandler","cancelId","traceReceivedNotification","handleNotification","isResponse","responseMessage","key","responsePromise","timerStart","traceReceivedResponse","handleResponse","number","responseHandler","handleInvalidMessage","toCancel","strategy","response","cancellationToken","add","queue","addMessageToQueue","lspMessage","isLSPMessage","timestamp","throwIfClosedOrDisposed","undefinedToNull","param","nullToUndefined","isNamedParam","computeSingleParam","auto","computeMessageParams","i","push","connection","messageParams","first","paramStart","paramEnd","map","notificationMessage","traceSendingNotification","onNotification","onProgress","_type","sendProgress","onUnhandledProgress","sendRequest","throwIfNotListening","last","disposable","traceSendingRequest","enableCancellation","async","r","MessageWriteError","onRequest","hasPendingResponse","_value","_tracer","sendNotificationOrTraceOptions","_sendNotification","_traceFormat","onUnhandledNotification","onDispose","PendingResponseRejected","values","AlreadyListening","throwIfListening","inspect","verbose","_disposable","CallbackList","bucket","_callbacks","_contexts","remove","foundCallbackWithDifferentContext","len","splice","invoke","ret","callbacks","contexts","apply","e","isEmpty","_options","_event","thisArgs","disposables","onFirstListenerAdd","_noop","onLastListenerRemove","array","stringArray","Number","every","elem","_a","First","AsOld","Last","AsNew","_map","_head","_tail","_size","_state","clear","touch","item","next","previous","addItemLast","addItemFirst","removeItem","forEach","callbackfn","thisArg","current","keys","iterator","Symbol","done","entries","toStringTag","trimOld","newSize","currentSize","toJSON","fromJSON","limit","ratio","_limit","_ratio","Math","min","max","checkTrim","peek","round","_chunks","_totalLength","append","chunk","toAppend","byteLength","tryReadHeaders","lowerCaseKeys","chunkIndex","offset","chunkBytesRead","row","_read","headers","split","header","index","indexOf","substr","trim","tryReadBody","numberOfBytes","byteCount","resultOffset","chunkPart","semaphore_1","ResolvedMessageReaderOptions","onPartialMessage","partialMessageEmitter","asError","fireClose","firePartialMessage","fromOptions","contentDecoder","contentDecoders","contentTypeDecoder","contentTypeDecoders","readable","_partialMessageTimeout","nextMessageLength","messageToken","readSemaphore","Semaphore","partialMessageTimeout","timeout","partialMessageTimer","contentLength","fromEntries","parseInt","isNaN","body","setPartialMessageTimer","clearPartialMessageTimer","lock","bytes","waitingTime","ResolvedMessageWriterOptions","count","contentTypeEncoder","contentEncoder","writeSemaphore","doWrite","join","AbstractMessageSignature","ParseError","InvalidRequest","jsonrpcReservedErrorRangeStart","serverErrorStart","MessageReadError","ConnectionInactive","ServerNotInitialized","UnknownErrorCode","jsonrpcReservedErrorRangeEnd","serverErrorEnd","_parameterStructures","_ral","ral","capacity","_capacity","_active","_waiting","thunk","runNext","active","doRunNext","err","CancellationState","Continue","buffers","request","SharedArrayBuffer","Int32Array","$cancellationData","_conn","Atomics","store","SharedArrayBufferCancellationToken","load","SharedArrayBufferCancellationTokenSource"],"sourceRoot":""}